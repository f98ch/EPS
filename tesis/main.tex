% {{{ Paquetes, comandos etc
%%
%%	AVISO IMPORTANTE
%%	Formato optimizado para el sistema operativo GNU/Linux 64 bits
%%	usar TexLive 2016 (o superior), http://www.ctan.org/tex-archive/systems/texlive/Images/
%%	usar TeXstudio 2.11, http://texstudio.sourceforge.net/

\documentclass[letterpaper,12pt]{thesisECFM}
\usepackage{macros}

%%	NO OLVIDE INCLUIR FUENTE DE LAS TABLAS Y FIGURAS

% Descomentar para anular recuadros en los hiperenlaces dentro del pdf
\hypersetup{pdfborder={0 0 0}}
\usepackage{bm} 
% Teoremas ---------------------------------------------------------
% estos ambientes son para teoremas, lemas, corolarios, otros
% si no los utiliza los puede obviar en su trabajo de graduación
\theoremstyle{plain}
\newtheorem{thm}{Teorema}[section]
\newtheorem{cor}{Corolario}[chapter]
\newtheorem{lem}{Lema}[chapter]
\newtheorem{prp}{Proposición}[chapter]

\theoremstyle{definition}
\newtheorem{prin}{Principio}[chapter]

\theoremstyle{definition}
\newtheorem{exa}{Ejemplo}[chapter]
\newtheorem{defn}{Definición}[chapter]
\newtheorem{axm}{Axioma}[chapter]
\usepackage[draft,inline,nomargin]{fixme} \fxsetup{theme=color}
\FXRegisterAuthor{cp}{acp}{\color{blue}CP}
\FXRegisterAuthor{fel}{afel}{\color{purple}F}

\theoremstyle{remark}
\newtheorem{rem}{Nota}[chapter]

% <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
% <<<<<<<<<<<<<<                                             >>>>>>>>>>>>>>>>>>
%                 Inicio preámbulo de José Alfredo de León
% <<<<<<<<<<<<<<                                             >>>>>>>>>>>>>>>>>>
% <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>



%\usepackage{lscape}		%% para poner tablas en orientación landscape
\usepackage{array}		%% para modificar cosas de entorno 'tabular'
\newcolumntype{P}[1]{>{\centering\arraybackslash}m{#1}} %para que en las tablas quede centrado verticalmente el texto


%% símbolos de mate y física --------------------------------------------------
\usepackage{amssymb}	
\usepackage{amsbsy}
\usepackage{physics}
%% ----------------------------------------------------------------------------


\usepackage{longtable}	%% tablas en más de una página
\usepackage{float}		%% para poder usar H, h! en entornos table y figure, por ej.
\usepackage{booktabs}

%% para poner subfiguras
\usepackage{caption} 
\usepackage{subcaption}

\usepackage{lipsum} % para poner texto equis
\usepackage{rotating} % para poner tablas rotadas
% \usepackage[inline]{showlabels} % Muestra las etiquetas en el documento

%%% ----------------------------------------------------------------------------
%% \usepackage[inline]{showlabels}		%% para mostrar labels en el PDF
		
			
\usepackage{graphicx}			%% para colocar imágenes
\graphicspath{ {./img/} }		%% ruta a carpeta con imágenes


%% Para enumerar las líneas del PDF -------------------------------------------
\usepackage[]{lineno} %\linenumbers
\linenumbers
\setlength\linenumbersep{3pt}
%% para que funcione mejor la numeración {{{
%% https://tex.stackexchange.com/questions/43648/why-doesnt-lineno-number-a-paragraph-when-it-is-followed-by-an-align-equation
%\newcommand*\patchAmsMathEnvironmentForLineno[1]{%
%  \expandafter\let\csname old#1\expandafter\endcsname\csname #1\endcsname
%  \expandafter\let\csname oldend#1\expandafter\endcsname\csname end#1\endcsname
%  \renewenvironment{#1}%
%     {\linenomath\csname old#1\endcsname}%
%     {\csname oldend#1\endcsname\endlinenomath}}% 
%\newcommand*\patchBothAmsMathEnvironmentsForLineno[1]{%
%  \patchAmsMathEnvironmentForLineno{#1}%
%  \patchAmsMathEnvironmentForLineno{#1*}}%
%\AtBeginDocument{%
%\patchBothAmsMathEnvironmentsForLineno{equation}%
%\patchBothAmsMathEnvironmentsForLineno{align}%
%\patchBothAmsMathEnvironmentsForLineno{flalign}%
%\patchBothAmsMathEnvironmentsForLineno{alignat}%
%\patchBothAmsMathEnvironmentsForLineno{gather}%
%\patchBothAmsMathEnvironmentsForLineno{multline}%
%}
%% }}}	
%% ----------------------------------------------------------------------------


%%%%%%%%%%%%   Inicio definición de comandos   %%%%%%%%%%%%%%%%
\newcommand{\fref}[1]{fig.~\ref{#1}}   \newcommand{\tref}[1]{tabla~\ref{#1}}     
\newcommand{\Fref}[1]{Fig.~\ref{#1}}  \newcommand{\Tref}[1]{Tabla~\ref{#1}}
\newcommand{\Cref}[1]{Cuadro~\ref{#1}}
\newcommand{\psii}{\psi_i}
\newcommand{\Pk}[1]{\ket{\psi_{#1} }}
\newcommand{\Pb}[1]{\bra{\psi_{#1} }}
\newcommand{\pk}{\ket{\psi}}
\newcommand{\M}{\mathcal{M}^{(N)}}
\newcommand{\E}{\mathcal{E}}
\newcommand{\Erho}{\mathcal{E}(\rho)}
\newcommand{\1}{\mathbb{1}}
\newcommand{\ten}{\otimes}
\newcommand{\h}[1]{\colorbox{yellow}{#1}}
\newcommand{\hi}{\mathcal{H}}
\newcommand{\txt}[1]{\text{#1}}
\newcommand{\here}{\h{\hspace{15cm}} }
\newcommand{\rhoi}{\dyad{\psii}{\psii}}
\newcommand{\ind}[2]{{{}^{#1}_{#2}}}
\newcommand{\rc}[1]{r_{#1}}
\newcommand{\pauli}[2]{\sigma_{#1}\otimes\sigma_{#2}}
\newcommand{\esqueleto}[1]{\textcolor{JAsColor}
{\noindent\textbf{Esqueleto:} #1}}
\newcommand{\ot}{\otimes}
\newtheorem{ex}{Ejemplo}[section]
\newcommand{\m}{\textcolor{JAsColor}{|}}
\newcommand{\taus}{\tau_{j_1,\ldots ,j_n}}
\newcommand{\tauijk}[3]{\boldmath{$\tau_{#1#2#3}$}}
\newcommand{\tauij}[2]{\boldmath{$\tau_{#1#2}$}}
\newcommand{\ep}{\textbf{Fuente:} elaboración propia.}
\newcommand{\subind}[2]{{}_{#1}^{#2}}
\newcommand{\ruskaiMap}{canal diagonal de Pauli constante sobre los ejes}
\newcommand{\ruskai}{canales diagonales de Pauli constantes sobre los ejes}
%%%%%%%%%%%   Fin definición de comandos   %%%%%%%%%%%%%%%%%%
\usepackage{tikz}
\usetikzlibrary{quantikz}

% Cosas que no sé porqué tengo ------------------------------------------------
\usepackage{natbib}
\usepackage{ctable} 
\usepackage{bbold}
\usepackage{fancybox}	
\usepackage{colortbl}
\usepackage{csquotes}
\usepackage{enumitem}

\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}}
\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}}
\renewcommand{\labelenumiv}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.\arabic{enumiv}}

\renewcommand{\thefootnote}{\fnsymbol{footnote}}


% <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
% <<<<<<<<<<<<<<                                             >>>>>>>>>>>>>>>>>>
%                   Fin preámbulo de José Alfredo de León
% <<<<<<<<<<<<<<                                             >>>>>>>>>>>>>>>>>>
% <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>



% Cuerpo de la tesis -----------------------------------------------

% Preámbulo
% }}}
\begin{document}
% Datos generales del trabajo de graduación, tabla de contenidos etc por ahi mas cosas {{{
\datosThesis%
{1}%						% física 1; matemática 2
{Implementación de canales cuánticos \\ de un qubit usando VQA}%		% Título del trabajo de graduación
{Felipe Antonio Ixcamparic Choy}%			% autor
{Dr. Ángel Giovanni Ramírez García\\y Dr. Carlos Francisco Pineda Zorrilla}%			% asesor
{agosto de 2024}		% mes y año de la orden de impresión
{2}							% femenino 1; masculino 2

\frontmatter
\tableofcontents    % Índice general vinculado
\figurasYtablas{1}{1}
% }}}
\chapter*{LISTA DE SÍMBOLOS} % {{{
% \phantomsection
\addcontentsline{toc}{chapter}{LISTA DE SÍMBOLOS}

\begin{description}[leftmargin=3cm, style=nextline]
  \item[$\mathcal{H}$] Espacio de Hilbert o espacio de estado.
  \item[$\ket{\psi}$] Representación del vector de estado en la notación de Dirac (\textit{ket}).
  \item[$\bra{\psi}$] Vector dual al estado $\ket{\psi}$ (\textit{bra}).
  \item[$\braket{\psi|\phi}$] Producto interno entre dos vectores en la notación de Dirac (\textit{braket}).
  \item[$\ketbra{\psi}{\phi}$] Producto externo, también llamado \textit{ketbra}.
  \item[$\overline{\braket{\psi|\phi}}$] Conjugado complejo del producto interno.
  \item[$\rho$] Matriz densidad de un sistema cuántico.
  \item[$\rho_{AB}$] Matriz densidad de un sistema compuesto A y B.
  \item[$\rho_A = \text{Tr}_B(\rho_{AB})$] Matriz densidad reducida del subsistema A (traza parcial sobre B).
  \item[$\text{Tr}(\cdot)$] Operación de traza sobre un operador.
  \item[$\gamma$] Pureza de un estado cuántico ($\gamma = \text{Tr}(\rho^2)$).
  \item[$\sigma_x, \sigma_y, \sigma_z$] Matrices de Pauli.
  \item[$R_x(\theta), R_y(\theta), R_z(\theta)$] Compuertas de rotación alrededor de los ejes X, Y y Z.
  \item[$H$] Compuerta de Hadamard.
  \item[$\text{CNOT}$] Compuerta de control-X (controlada).
  \item[$\Lambda_E$] Matriz de Choi del canal cuántico $E$.
  \item[$\{E_k\}$] Conjunto de operadores de Kraus para un canal cuántico.
  \item[$E(\rho)$] Acción del canal cuántico $E$ sobre el estado $\rho$.
  \item[$p$] Parámetro de despolarización (probabilidad de ruido).
  \item[$F(\rho, \sigma)$] Fidelidad entre dos estados cuánticos.
  \item[$F_{\text{proc}}$] Fidelidad de proceso cuántico.
  \item[$U(\bm{\theta})$] Circuito parametrizado o ansatz en un VQA.
  \item[$C(\bm{\theta})$] Función de costo en un algoritmo variacional cuántico.
  \item[$\bm{\theta}$] Vector de parámetros del ansatz.
  \item[$\text{argmin}(-C(\bm{\theta}))$] Optimización clásica sobre los parámetros del VQA.
\end{description}
% }}}
\chapter*{OBJETIVOS} % {{{
% \phantomsection
\addcontentsline{toc}{chapter}{OBJETIVOS}
\section*{General} 
Estudiar y desarrollar algoritmos variacionales cuánticos para la implementación de canales cuánticos de un  qubit en computadoras cuánticas.

\section*{Específicos}
\begin{itemize}
    \item Estudiar la teoría y uso de computadoras cuánticas.
    \item Comprender las definiciones fundamentales de la teoría de sistemas cuánticos abiertos y canales cuánticos.
    \item Investigar el uso de los algoritmos variacionales cuánticos en la resolución de problemas de información cuántica.
    \item Implementar canales cuánticos de un qubit en computadoras cuánticas y analizar su comportamiento.
\end{itemize}
% }}}
\chapter*{INTRODUCCIÓN} % {{{
\addcontentsline{toc}{chapter}{INTRODUCCIÓN}
El estudio de sistemas cuánticos abiertos es fundamental para el desarrollo de tecnologías cuánticas, especialmente en el contexto de la computación y la información cuántica \cite{nielsen_chuang_2011, schlosshauer2007decoherence}. Para describir la dinámica de estos sistemas se utilizan los canales cuánticos, definidos como operadores completamente positivos y que preservan la traza (CPTP) \cite{Choi2024}.Es importante comprender e implementar estos canales para caracterizar el ruido en computadoras cuánticas reales, especialmente en dispositivos de propósito cuántico limitados como los de la era de tecnología ruidosa de escala media (NISQ). Entre las técnicas más prometedoras para enfrentar estos desafíos se encuentran los algoritmos variacionales cuánticos (VQA), que combinan circuitos cuánticos parametrizados con estrategias de optimización clásica. Este enfoque híbrido ha demostrado ser eficaz para distintas aplicaciones como el \textit{variational quantum eigensolver} (VQE), encontrar estados fundamentales, estados excitados, entre otros \cite{VQA}.

En este trabajo se propone la implementación de canales cuánticos de un qubit, con énfasis en el canal despolarizante, utilizando los VQA. Con este objetivo, se estudiarán, en la primera parte del trabajo, los fundamentos teóricos de los canales cuánticos y su representación matemática, haciendo énfasis en el formalismo de Choi y la tomografía de procesos. Posteriormente, se construirá un VQA con el uso de un \textit{hardware efficient ansatz} (HEA)  que implementará la acción del canal sobre un sistema cuántico, el cual es optimizado en función  de la fidelidad de proceso. Este proceso se llevará a cabo tanto en un simualdor, como en una computadora cuántica real, lo que permitirá contrastar el rendimiento ideal frente al hardware disponible. Finalmente, se discutirán las implicaciones de estos resultados y se propondrán líneas de trabajo futuro en el contexto de la computación cuántica.

El desarrollo y análisis de esta propuesta permiten no solo validar la factibilidad de los VQA para la simulación de canales cuánticos, sino también ofrecer una herramienta versátil para el diseño de algoritmos tolerantes a errores y estrategias de corrección cuántica. 
\cpnote{Esta es la intro total? Me parece que el primer parrafo y el segundo no están 
bien conectados} \felnote{Corregido: Redacté la introducción final en esta iteración.}



% El estudio de la dinámica de sistemas cuánticos abiertos es fundamental para el avance de la computación e información cuántica. Los canales cuánticos describen la evolución de estados cuánticos en  interacción con su entorno, y son clave para el entendimiento de este tipo de sistemas.

% En este trabajo, nos enfocamos en la aplicación de algoritmos variacionales cuánticos (VQA) para la inicialización y optimización de canales cuánticos en plataformas de computación cuántica. Los VQA, a través de su enfoque híbrido que combina computación cuántica y optimización clásica, nos ofrecen una técnica óptima para ajustar los parámetros que gobiernan los canales cuánticos, permitiendo una mayor precisión y control en el procesamiento cuántico.


\mainmatter % Inicio del contenido principal
\chapter{FUNDAMENTOS TEÓRICOS} \label{cap:fundamentos:teoricos} % {{{
% Intro de los fundamento {{{
Para implementar canales cuánticos en plataformas actuales, es necesario
establecer un marco teórico que permita describir y manipular estados
cuánticos. En la sección~\ref{sec:matriz_densidad}, se introduce el formalismo
de la matriz densidad, junto con los conceptos de pureza y traza parcial,
fundamentales para caracterizar estados puros y mixtos. Posteriormente, en la
sección \ref{sec:circuitos_cuanticos}, se presentan los circuitos cuánticos
como herramienta para ejecutar operaciones sobre qubits. Se describen las
compuertas cuánticas, las mediciones, y su representación en la esfera de
Bloch. También se explica el proceso de transpilación y la influencia de la
topología física de las computadoras cuánticas, en particular aquellas
disponibles en la  plataforma \textit{IBM Quantum Experience}, que será
utilizada en este trabajo.

Con estos elementos, la sección \ref{sec:canales_cuanticos} introduce
formalmente los canales cuánticos como operadores completamente positivos y que
preservan la traza (CPTP). Se analizan sus representaciones, destacando la
matriz de Choi por su utilidad para caracterizarlos y compararlos. Como caso de
estudio, se examina el canal despolarizante, cuya implementación se aborda en
los capítulos \ref{cap:algoritmos_variacionales} y \ref{cap:resultados}.
Finalmente, en la misma sección, se presentan las herramientas necesarias para
caracterizar experimentalmente un canal cuántico: la tomografía y la fidelidad
de proceso. Estas permitirán validar y evaluar los canales implementados. Al
finalizar este capítulo, el lector contará con una base sólida para comprender
cómo se definen, manipulan y validan canales cuánticos en computadoras
cuánticas. 
% }}}
\section{Matriz Densidad} % {{{
\label{sec:matriz_densidad}
\subsection{Estados puros y mixtos} % {{{
Para describir un sistema cuántico usamos un vector complejo $\ket{\psi}$,
también llamado \textit{ket} o estado cuántico. El
estado cuántico puede estar representado por la ecuación: 
\begin{equation}
     \label{eq:1.1}
         \ket{\psi} = \sum_{i=1}^{d} c_i \ket{i},
\end{equation}
con $c_i$ coeficientes complejos,
$\{\ket{i}\}$ una base ortonormal en el espacio de Hilbert $\mathcal{H}$ del
sistema  y $d$ la dimensión del
sistema cuántico.  Los coeficientes deben cumplir con la condición de
normalización \cite{nielsen_chuang_2011}:
    \begin{equation}
    \label{ec::1.2}
           \sum_i |c_i|^2=\braket{\psi}{\psi}=1, 
    \end{equation} 
donde $|c_i|^2$ es la probabilidad de encontrar al sistema en el estado
$\ket{i}$ al medir el observable asociado con la base $\{\ket{i} \}$.

\begin{ex} \label{ex: dens1}\end{ex} Si tenemos un sistema de un
qubit~\footnote{Qubit es un sistema cuántico de dos estados (o dos niveles). Es
la
unidad básica de información de una computadora cuántica siendo su base los
autovectores de el operador de Pauli 
$\sigma_z$.}, su base estaría conformada
por los estados $\{{\ket{0},\ket{1}}\}$, con vectores:
\begin{equation}
\ket{0} = \begin{bmatrix} 
    1 \\
    0 \\
    \end{bmatrix}, \quad \ket{1}=\begin{bmatrix} 
    0 \\
    1 \\
    \end{bmatrix},     
\end{equation} 
    por lo tanto su vector de estado $\ket{\psi}$ sería:
    \begin{equation}
      \ket{\psi} = c_0 \ket{0} + c_1 \ket{1},   
    \end{equation}
    y al medirlo tendría probabilidades de que colapse en su respectivo estado:
    \begin{equation}
     p_0=|c_0|^2, \quad p_1=|c_1|^2.
    \end{equation}
% \felnote{Párrafos nuevos (Los siguientes párrafos sirven como introducción
% para estados puros y mixto  dando paso a explicarse con la matriz densidad
% (línea 57 en adelante) =================}
Notemos que en el ejemplo hay un único estado asociado al sistema $\ket{\psi}$.
En estos casos, decimos que el sistema es descrito por un estado puro.
Un sistema cuántico puede estar sometido a factores que eviten describirlo con
un estado puro.  Entonces nuestro sistema es descrito por un ensamble
estadístico de estados $\{\ket{\psi_i} \}$  con probabilidades o ``pesos''
$\{p_i\}$. El ensamble que describe al sistema  es llamado un estado mixto.

Los estados puros como mixtos pueden ser descritos por un operador,
conocido como matriz densidad $\rho$. Para estados puros tenemos:
    \begin{equation}
        \label{ec:dens_puros}
        \rho = \ketbra{\psi},
    \end{equation}
mientras que para los estados mixtos es:
\begin{equation}
\label{dens_mixtos}
    \rho = \sum_{i=1}^{n} p_i \ketbra{\psi_i},
\end{equation}
con $n$ el número de estados del ensamble y $p_i$ el 'peso' mencionado
anteriormente, cumpliendo con la condición $\sum p_i =1$.
Si damos una base ortonormal $\{\ket{i}\}$, con $i=1,2,...,d$, veremos que los elementos de la
matriz densidad serán \cite{princip_quantum}:
\begin{equation}
    \label{eq:rho_ij}
    \rho_{ij} = \bra{i} \rho \ket{j}.
\end{equation}
   
La matriz densidad cuenta con propiedades que deben ser satisfechas, por ello
enunciaremos las propiedades mostradas en el libro de  Benneti y Casati
\cite{princip_quantum}, así como su demostración :
\begin{enumerate}
\item $\rho$ es Hermítico, es decir $\rho = \rho^{\dagger}.$\\ 
La transpuesta conjugada del operador $\rho$ es:
\begin{align}
    \label{ec:dagger}
    \rho^{\dagger}  & = \left( \sum p_i \ketbra{\psi_i}  \right)^{\dagger}.
\end{align}
Esta cumple con la siguiente propiedad:
\begin{align}
    (AB)^{\dagger} = B^{\dagger} A^{\dagger},
\end{align}
para cualquier matriz de dimensión $m\times n $ para $A$,  y $n \times p$ para
$B$. Al ser $A = \ket{\psi_i}$ de dimensión $1\times n$ y $B = \bra{\psi_i}$ de
dimensión $n \times 1$ podemos utilizar esta propiedad. Consecuentemente
reescribimos la ecuación $\ref{ec:dagger}$ como
\begin{align}
    \rho^{\dagger} = \sum p_i  \bra{\psi_i}^{\dagger} \ket{\psi_i}^{\dagger} = \sum p_i \ketbra{\psi_i}.  \blacksquare
\end{align}

\item $\rho$ posee traza unitaria.\\
La traza se define para una matriz densidad como:
\begin{equation}
    \label{ec:1.18}
    \text{Tr}(\rho) = \sum_{k=1}^{d} \bra{e_k} \rho \ket{e_k},
\end{equation}
siendo $\{\ket{e_k}\}$ una base ortonormal del espacio de Hilbert del sistema y $d$ su
dimensión. Por ello tenemos
\begin{align}
    \text{Tr}(\rho) & = \sum_{i,k} \bra{e_k}p_i\ket{\psi_i} \braket{\psi_i}{e_k} \\
    & = \sum_i p_i \bra{\psi_i} \left( \sum_k \ketbra{e_k} \right) \ket{\psi_i}
= \sum{p_i} \braket{\psi_i} = 1.
\end{align}
% \begin{align}
%     \text{Tr}(\rho) & = \sum_{i=1}^{l} p_k c_i^{(k)}c_i^{(k)\ast} \\
%     & = \sum_{i=1}^{l} p_k |c_i^{(k)}|^2 \\
%     & =  \sum_{i=1}^{l} p_k =1.\blacksquare
% \end{align}
\item $\rho$ es un operador no negativo. Es decir, que para cualquier estado $\ket{\phi}$ en el estado de Hilbert $\mathcal{H}$, tenemos que $\bra{\phi}\rho\ket{\phi} \geq 0$.\\
Si anotamos para un estado $\ket{\phi}$:
\begin{align}
\bra{\phi}\rho\ket{\phi} & = \bra{\phi} \left(\sum p_i \ket{\psi_i} \bra{\psi_i}   \right)     \ket{\phi}\\
& = \sum p_i \bra{\phi}\ket{\psi_i}\bra{\psi_i}\ket{\phi}  = \sum p_i \bra{\phi}\ket{\psi_i} \bra{\phi}\ket{\psi_i}^{\star}\\
& = \sum p_i |\bra{\phi}\ket{\psi_i}| ^2 \geq 0. \blacksquare
\end{align}  
Esta condición también es conocida como condición de positividad \cite{nielsen_chuang_2011}.
\end{enumerate}

% }}}
\subsection{Pureza y traza parcial} % {{{
Para medir que tanta información o que tan mixto es un estado cuántico se hace uso de la pureza, criterio descrito por la ecuación:
\begin{equation}
    \label{ec::1.25}
    \gamma = \text{Tr}(\rho ^2),
\end{equation}
con $\gamma=1$ para un estado puro, mientras que $\gamma < 1$ para un estado
mixto. Además, la pureza está limitada por las cotas $ \frac{1}{d}\leq\gamma\leq 1$.  Para probar este criterio iniciamos con la descomposición espectral
\cite{princip_quantum} para la matriz densidad $\rho$ :
    \begin{equation} 
        \label{ec:dens_espectral}
        \rho = \sum_{j} \lambda_j \ketbra{j},
    \end{equation}
siendo $\ket{j}$ vectores  qubit normalizados y ortogonales y $d$ la dimensión del sistema, con  $\lambda_j \geq0$ ya que $\rho$ es positivo. 
 Usando la descomposición espectral nuevamente para $\rho^2$ tenemos:
    \begin{align}
        \rho^2 & = \left( \sum_{j} \lambda_j \ketbra{j} \right) \left( \sum_{j} \lambda_j \ketbra{j} \right) \\
        &= \sum_{j} \lambda^2_j \ket{j}\braket{j}\bra{j} \\
        & = \sum_{j} \lambda_j^2\ketbra{j}.
    \end{align}
Si obtenemos la traza de $\rho^2$ concluimos: 
    \begin{equation}
    \label{eq:pureza_lambdas}
    \gamma=\sum_j\lambda_j^2.
    \end{equation} 
Notemos que los autovalores $\lambda_j$ deben cumplir también con la propiedad 2, es decir:
    \begin{equation}
    \label{ec:dens_eigvals}
    \sum_j \lambda_j = 1.
    \end{equation} 
Por lo tanto, la condición $\gamma = 1$ se cumple si y solo si existe un único
índice $\overline{j}$ tal que $\lambda_{\overline{j}} = 1$, y $\lambda_j = 0$
para todo $j \ne \overline{j}$.  Esto corresponde a un estado puro, ya que la matriz densidad se
reduce a un proyector sobre un solo estado:
\begin{equation}
\rho  = \lambda_{\overline{j}} \ketbra{\overline{j}} = \ketbra{\overline{j}},
\end{equation}
que es la misma representación vista en la ecuación (\ref{ec:dens_puros}). Por
otro lado, en un estado mixto, la matriz densidad $\rho$ tiene más de un
autovalor $\lambda_j$ distinto de cero, todos en el rango $0 < \lambda_j < 1$.
Por consiguiente:
    \begin{align}
        \sum_j \lambda_j^2 & < \sum_j \lambda_j =1 \\
        \therefore \gamma & < 1 \square
     \end{align}
La demostración anterior prueba la cota superior de la pureza, para la cota
inferior es necesario agregar un teorema \cite{jensen_wolfram}:
  %Estos  solo están para el \felnote
\begin{thm}
\textbf{(Desigualdad de Jensen):} \label{thm:jensen}  Sean $w_1,...,w_n$
números positivos que sumen $1$ y $f$ una función real continua convexa,
entonces:
\begin{equation}
    f \left( \sum_j w_j x_j  \right) \leq \sum_j w_j f(x_j).
\end{equation}
\end{thm}

Si aplicamos esta desigualdad con la función convexa $x \xrightarrow{}x^2$,  a
la suma $\sum_j \lambda_j /d$ (siendo $1/d$ el peso de $j$) tendremos:
    \begin{align}
    \label{eq:desig_jens}
        \left( \frac{\sum_j  \lambda_j}{d}\right)^2  & \leq \frac{1}{d} \sum_j \lambda_j^2.
    \end{align}
Por lo visto en $(\ref{ec:dens_eigvals}),(\ref{eq:pureza_lambdas})$ aplicado a $(\ref{eq:desig_jens})$ concluimos con:
\begin{equation}
    \frac{1}{d} \leq \gamma, 
\end{equation}
demostrando que las cotas de la pureza son $\frac{1}{d} \leq \gamma \leq
1$.$\blacksquare$ 

Cuando trabajamos con un sistema conformado por dos o más sistemas físicos
distintos se le conoce como un sistema compuesto.  El espacio de Hilbert
correspondiente al estado que describe a este sistema, es el producto
tensorial de cada uno de los espacios $H_i$ asociados a los subsistemas: 
\begin{equation}
H_T=H_1 \otimes H_2\otimes ...\otimes H_n.
\end{equation}
 Existen estados puros que podemos describir como el producto tensorial: 
\begin{equation}
    \ket{\psi}_T = \ket{\psi}_1 \otimes ... \otimes \ket{\psi_n},
\end{equation}
a los que su matriz densidad correspondiente sería \cite{nielsen_chuang_2011}
\footnote{Para este caso se utilizan números para indicar el estado $\rho$ que
describe al $i$-ésimo sistema, esto también puede ser representado con letras
mayúsculas tales como $\rho_A$ describiendo a un primer sistema $A$. En
adelante se utilizarán letras mayúsculas como subíndices para mantener
consistencia, y no confundirse con componentes de una matriz densidad como en
la ecuación \ref{eq:rho_ij}.}: 
\begin{align}
    \rho_T  & = \rho_1 \otimes \rho_2 \otimes  ... \otimes \rho_n \\
            & = \ketbra{\psi_1} \otimes \ketbra{\psi_2} ... \otimes \ketbra{\psi_n}. 
\end{align}
Este no es el caso general para los sistemas compuestos, sin embargo, será con
el que trabajemos en los siguientes capítulos.

Al trabajar con sistemas compuestos puede darse el caso donde no conozcamos
uno, o varios de los estados que describan a sus subsistemas. Entonces, para
dar una descripción a los subsistemas se usa la matriz densidad reducida.
Utilizaremos la definición dada por Nielsen y Chuang
\cite{nielsen_chuang_2011} 
\begin{quote}
    Si tenemos a los sistemas físicos $A$,$B$ cuyo sistema compuesto se describe
por el estado $\rho_{AB}$. Entonces el subsistema $A$ puede ser descrito por
medio de la matriz densidad reducida $\rho_A$:
\begin{equation}
    \rho_A \equiv \text{Tr}_B(\rho_{AB}),
\end{equation}
con $\text{Tr}_B$ un mapeo de operadores, conocido como traza parcial, que
actúa sobre el sistema compuesto. Si buscamos trazar parcialmente el subsistema
$B$ obtenemos:
\begin{equation}
    \text{Tr}_B(\ket{i_A}\bra{j_A} \otimes \ket{i_B}\bra{j_B}  ) \equiv \ket{i_A} \bra{j_A} \text{Tr}(\ket{i_B}\bra{j_B}),
\end{equation}
siendo $\ket{i_A}$ y $\ket{j_A}$ un par de vectores cualquiera en el espacio de
$A$, análogamente $\ket{i_B}$, $\ket{j_B}$ para el espacio de $B$. Por lo que
la traza $\text{Tr}$ en $B$ es:
\begin{equation*}
    \text{Tr}(\ket{i_B}\bra{j_B}) = \bra{j_B}\ket{i_B}.
\end{equation*}
Similarmente podemos calcular la matriz densidad para el sistema reducido $B$
trazando parcialmente $A$ como:
\begin{equation}
    \text{Tr}_A(\ket{i_A}\bra{j_A} \otimes \ket{i_B}\bra{j_B}  ) \equiv  \text{Tr}(\ket{i_A} \bra{j_A}) \ket{i_B}\bra{j_B}.
\end{equation}
\end{quote}
\begin{ex}\label{ex:traza parcial} \end{ex}  Consideremos un estado compuesto puro, conformado por dos estados puros $\rho_{AB} = \Omega  \otimes \sigma$. Si buscamos describir al subsistema $\rho_{B}$ tenemos:
\begin{equation}
    \rho_{B} = \text{Tr}_{A} (\Omega  \otimes \sigma) = \Omega \text{Tr}(\sigma) = \Omega, 
\end{equation}
análogamente si buscáramos $\rho_A$:
\begin{equation}
     \rho_{A} = \text{Tr}_{B} (\Omega  \otimes \sigma) = \text{Tr}(\Omega) \sigma = \sigma.
\end{equation}

El estado que describe a este sistema es llamado un estado separable. Ya que al hallar sus subsistemas, veremos que puede escribirse como un producto tensorial $\rho_A \otimes \rho_B$, indicando que ambos subsistemas no estan correlacionados.   

\begin{ex} \label{ex: traza parcial2} \end{ex} 
Consideremos un estado puro de dos qubits conocido como el estado de \textit{Bell} 
\begin{equation}
\label{ec:1.45}
    \ket{\psi_{AB}}=\frac{1}{\sqrt{2}} (\ket{0_A0_B} + \ket{1_A1_B}  ).
\end{equation}
Este estado se dice que está \textit{entrelazado}, dado que no es separable, es decir, $ \ket{\psi_{AB}} \neq \ket{\psi_A} \otimes \ket{\psi_B}$, siendo $\ket{\psi_A},\ket{\psi_B}$ estados puros que describen a los sistemas $A,B$ respectivamente. Esto es signo existe una correlación entre ambos subsistemas.

 Si hallamos la matriz densidad del sistema tendríamos:
\begin{align}
    \rho & =  \frac{1}{2}\left[ \ket{0_A0_B} + \ket{1_A1_B}        \right)\left( \ket{0_A0_B} + \ket{1_A1_B}        \right]\\
        & = \frac{1}{2} \left[ \ketbra{0_A0_B} + \ketbra{1_A1_B}{0_A0_B} + \ketbra{0_A0_B}{1_A1_B} + \ketbra{1_A1_B} \right].
\end{align}
Si buscamos la matriz reducida del subsistema $B$ tenemos:
\begin{align}
    \rho_B  & = \text{Tr}_A(\rho_{AB})\\
        & =  \frac{1}{2} \large[ \text{Tr}_A(\ketbra{0_A0_B}) + \text{Tr}_A(\ketbra{1_A1_B}{0_A0_B})\\
        & \qquad +\text{Tr}_A(\ketbra{0_A0_B}{1_A1_B}) + \text{Tr}_A(\ketbra{1_A1_B}{1_A1_B})  \large] \\
      & = \frac{1}{2} \left[ \ketbra{0_B} + \ketbra{1_B}  \right]  = \frac{1}{2} \mathbb{1}.
\end{align}
Notemos que $\gamma({\rho_B}) = \frac{1}{2} < 1$ le corresponde un estado mixto. También veamos que nuestro sistema compuesto no se puede describir de alguna forma con el producto $\rho_A \otimes \rho_B$ para las matrices densidad reducidas. Esto indica que las correlaciones entre $A,B$ no se incluyen en el producto tensorial de ambos subsistemas. 

% }}}
% }}}
\section{Circuitos Cuánticos} % {{{
\label{sec:circuitos_cuanticos}
\subsection{Compuertas y mediciones cuánticas} % {{{

Previo a hablar sobre compuertas cuánticas, es necesario introducir una forma
de representar geométricamente al qubit. Para ello utilizamos la esfera de
Bloch. Esta esfera será una herramienta que nos permitirá visualizar los
cambios del estado de un qubit bajo diversas transformaciones unitarias $U$.

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.70]{imagenes/Bloch.png}
    \caption{Representación de un estado cuántico en la esfera de Bloch.
\textbf{Fuente:} Nielsen y Chuang \cite{nielsen_chuang_2011}.}
    \label{fig:Bloch}
\end{figure}
La representación de un qubit en la esfera de Bloch esta dada por la ecuación: 
\begin{equation}
    \label{ec:Bloch_rep}
    \ket{\psi} = \cos{\frac{\theta}{2}}\ket{0}+ e^{i\phi}\sin{\frac{\theta}{2}}\ket{1},
\end{equation}
con $\theta,\phi$,  ángulos que recorren la esfera (ver figura \ref{fig:Bloch}), y toman los valores:
\begin{equation}
 0 \leq \theta \leq \pi ;  \quad   0 \leq \phi \leq 2\pi.
\end{equation} 
La ecuación \ref{ec:Bloch_rep} nos permite representar estados puros en la esfera de Bloch. Sin embargo, para cualquier estado $\rho$ de un qubit, usamos el vector de Bloch, cuyas componentes señalan un punto en la esfera \cite{princip_quantum}.

Para definir el vector de Bloch transformamos los parámetros $\theta,\phi$ a coordenadas cartesianas como $\textbf{r} = (x,y,z)$ de la forma:
\begin{equation}
\left\{\begin{matrix}
x = |\textbf{r}| \sin{(\theta)} \cos{(\phi)} \\
y = |\textbf{r}| \sin{(\theta)} \sin{(\phi)} \\
z = |\textbf{r}| \cos{(\theta)}.
\end{matrix}\right. 
\end{equation}
El valor absoluto $|\textbf{r}|=1$ para estados puros, mientras que
$|\textbf{r}|<1$ para estados mixtos. Notemos que los estados puros se
encuentran en la superficie de la esfera de Bloch, mientras que los estados
mixtos en el interior. Por lo tanto, obtenemos otra representación útil de la
ecuación \ref{ec:Bloch_rep} mediante el operador $\rho$ para estados puros como
:
\begin{equation}    \label{ec:vec_bloch}
    \rho  = \frac{1}{2} ( \mathbb{1} + \textbf{r} \cdot \sigma),
\end{equation}
donde $\sigma $ es llamado el vector de Pauli, con las matrices:
\begin{equation}
\label{ec:pauli_matrix}
\sigma_x= \begin{pmatrix}
    0 & 1 \\
    1 & 0 \\
\end{pmatrix} ;\quad 
\sigma_y= \begin{pmatrix}
    0 & -i \\
    i & 0 \\
\end{pmatrix};\quad
\sigma_z= \begin{pmatrix}
    1 & 0 \\
    0 & -1 \\
\end{pmatrix}.
\end{equation}

Las compuertas cuánticas son operadores unitarios reversibles $U$ de dimensión
$n\times n $. Estas actúan linealmente sobre qubits que pueden estar en
superposición. Además, se visualizan por cajas que contienen las iniciales del
operador aplicado (ver figura \ref{fig:compuerta}). 

  \begin{figure}[h]
        \centering
        \begin{quantikz}
        \qw & \gate{U} & \qw
        \end{quantikz}
        \caption{Representación de compuerta cuántica $U$. \textbf{Fuente:} elaboración propia.     }
        \label{fig:compuerta}
    \end{figure}
    
Los operadores $U$ que actúan sobre un qubit son de dimensión $2 \times 2$, y se representan por la matriz:
\begin{equation}
    U = \begin{pmatrix}
    u_{00} & u_{01}  \\
    u_{10} & u_{11} 
    \end{pmatrix}.
\end{equation}
Nos enfocaremos en un conjunto específico de compuertas de uno y varios qubits
necesarias para este trabajo, comenzando con las compuertas de rotación en los
ejes de la esfera de Bloch: $R_x$, $R_y$ y $R_z$. Estas compuertas rotan el
estado del qubit alrededor de cada eje de la esfera de Bloch y pueden
interpretarse como versiones parametrizadas de los operadores de Pauli (ver
ecuación \ref{ec:pauli_matrix}). La representación de cada rotación es:
\begin{align}
    R_x(\theta) &=  \begin{bmatrix}
    \cos{(\theta)} & -i\sin{(\theta)}\\
    -i\sin{(\theta)} & \cos{(\theta)} 
    \end{bmatrix},  \\
    R_y(\theta) &=  \begin{bmatrix}
    \cos{(\theta)} & -\sin{(\theta)}\\
    \sin{(\theta)} & \cos{(\theta)} 
    \end{bmatrix}, \\
    R_z(\theta) &=  \begin{bmatrix}
    e^{-i\theta} & 0\\
    0 & e^{i\theta} 
    \end{bmatrix}.
\end{align}
Si aplicamos una rotación con un ángulo $\pi/2$ es equivalente a aplicar los
operadores de Pauli $X,Y,Z$. Esto cambia la dirección del estado en su
respectivo eje (ver figura \ref{fig:rep_pauli}). 

\begin{figure}[h!] % {{{
    \centering
    % Subfigura para X y Y en la misma fila
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{imagenes/Paulix.png}
        \caption{Representación visual de la acción de $X$ en la esfera de Bloch.}
        \label{fig:Paulix}
    \end{subfigure}
    \hspace{1em} % Espacio horizontal entre las dos primeras subfiguras
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{imagenes/Pauliy.png}
        \caption{Representación visual de la acción de $Y$ en la esfera de Bloch.}
        \label{fig:Pauliy}
    \end{subfigure}

    % Subfigura para Z en una fila inferior
    \vspace{1em} % Espacio vertical entre las filas
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{imagenes/Pauliz.png}
        \caption{Representación visual de la acción de $Z$ en la esfera de Bloch.}
        \label{fig:Pauliz}
    \end{subfigure}
    
    \caption{Representación visual de las compuertas de rotación en la esfera de Bloch. \textbf{Fuente:} elaboración propia}
    \label{fig:rep_pauli}
\end{figure} % }}}

Además de las compuertas de Pauli, necesitamos de una compuerta que haga otro
tipo de cambio en la base de un qubit, como lo es la compuerta de
Hadamard. Esta compuerta tiene la característica de poner en
superposición de igual amplitud a los estados de la base de un qubit.
La matriz que la describe es
\begin{equation}
    H= \frac{1}{\sqrt{2}}
    \begin{pmatrix}
     1& 1 \\
     1& -1 \\
    \end{pmatrix},
\end{equation} 
Su acción se ve como una rotación de $\pi$ radiantes sobre el eje
$(x+z)/\sqrt{2}$ en la esfera de Bloch.  También puede descomponerse como la
sucesión de $\pi$ radianes en el eje $x$, seguido de una rotación de $\pi/2$ en
$y$ (ver figura \ref{fig:hadamard}).

\begin{figure}
    \centering
    \includegraphics[scale=0.15]{imagenes/Haddamard.png}
    \caption{Representación visual de la acción de la compuerta de Hadamard sobre un estado inicial $\ket{0}$ en la esfera de Bloch. \textbf{Fuente}: elaboración propia.}
    \label{fig:hadamard}
\end{figure}

Las compuertas anteriores son importantes al trabajar con un qubit, sin
embargo, para trabajar con varios qubits usamos compuertas de control.
Estas compuertas hacen uso de un qubit con el rol de  control, el cual
regula la acción de otros qubits que tienen el rol de objetivo. Las compuertas de control unitario de dos qubits $CU$, son representadas por la matriz:
\begin{equation}
    CU = 
    \begin{pmatrix}
    \label{ec:2.27}
    1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
     0& 0 & u_{00} & u_{01} \\
     0&  0&  u_{10}&u_{11} \\
    \end{pmatrix},
\end{equation}
donde $u_{ij}$ son los elementos de la compuerta unitaria $U$ que actúa sobre el qubit objetivo.

En esta matriz, el primer cuadrante es una identidad que garantiza que, si el qubit de control está en el estado $\ket{0}$, el qubit objetivo permanece sin cambios. Si el qubit de control está en $\ket{1}$, el bloque inferior derecho aplica la transformación unitaria $U$ al qubit objetivo. Esto permite implementar distintas compuertas de control, como $CR_x$ \footnote{La compuerta $CX$ es comúnmente conocida como compuerta $CNOT$. En adelante, cuando hablemos de la compuerta $CNOT$, nos referimos a $CR_x(\pi/2)$.}  o $CR_z$, ajustando los parámetros $u_{ij}$.

Al realizar una medición cuántica hace que nuestro qubit colapse a uno de los estados de la base $ \sigma_z$. Sin embargo, es posible realizar un cambio de base y poder medir en otro tipo de bases. A continuación daremos la definición de Nielsen y Chuang \cite{nielsen_chuang_2011}:
\begin{quote}
Dada cualquier base de estados $\ket{a},\ket{b}$ para un qubit, es posible expresar un estado arbitrario como una combinación lineal $\alpha\ket{a}+\beta\ket{b}$ de esos estados. Además, siempre que los estados sean ortonormales,  \textbf{es posible realizar una medición respecto a la base de $\ket{a},\ket{b}$}, dando un resultado $a$, con probabilidad $|\alpha|^2$ y $b$, con probabilidad $|\beta|^2$. 
\end{quote}

\begin{ex}\label{Ejemplo 2.1.1} \end{ex}
 Supongamos un estado arbitrario $\ket{\psi}=\alpha \ket{0} + \beta\ket{1}$, del cual buscamos medir en una nueva base:
 \begin{align}
 \label{ec:2.32}
     \ket{+} & \equiv \frac{1}{\sqrt{2}} (\ket{0} + \ket{1}) \\
    \ket{-} & \equiv \frac{1}{\sqrt{2}} (\ket{0}-\ket{1}).
 \end{align}
Si re expresamos $\ket{\psi}$ en la nueva base veremos que:
 \begin{align}
     \ket{\psi}  &= \alpha\ket{0} + \beta\ket{1} \\
                 &= \frac{\alpha}{\sqrt{2}} ( \ket{+ } + \ket{-}) + \frac{\beta}{\sqrt{2}} (\ket{+} + \ket{-})\\
                 & = \frac{\alpha+\beta}{\sqrt{2}} \ket{+} + \frac{\alpha-\beta}{\sqrt{2}} \ket{-} . 
 \end{align}
Al medirlo en la base $\{\ket{+}, \ket{-}\}$, obtendremos probabilidades $|\alpha+\beta|^2$ y $|\alpha-\beta|^2$ respectivamente.

Las mediciones en otras bases serán de utilidad para la tomografía de estado ya que hace uso de distintas mediciones en distintas bases para recuperar la información de un estado cuántico.
% }}}
\subsection{Composición de circuitos cuánticos} % {{{
Un circuito cuántico es una rutina computacional con operadores que actúan
sobre qubits. Los circuitos se conforman por cables, compuertas y mediciones.
Un cable se usa como representación de un qubit en estado inicial $\ket{0}$.  
Como vimos en la sección anterior, las compuertas cuánticas se representan con
cajas que contienen el nombre del operador, además se posicionan en el cable del qubit que actúan. Por otro lado, las compuertas de
control se identifican con un punto para el qubit de control unido a una caja
del qubit target (ver figura \ref{fig:circuito0}).

\begin{figure}[h]
    \centering
    \begin{quantikz}
    \lstick{$\ket{0}$} & \gate{X} & \ctrl{1} & \qw  \\
    \lstick{$\ket{0}$} & \qw & \gate{R_y} & \qw 
    \end{quantikz}
    \caption{Circuito de ejemplo para crear interacción entre dos qubits. \textbf{Fuente:} elaboración propia.}
    \label{fig:circuito0}
\end{figure}


Por el lado de  la medición cuántica, se representa mediante un símbolo de
``medidor''
que colapsa el estado cuántico del qubit y almacena el resultado en
bits clásicos (ver figura \ref{fig:circuito2}). En los diagramas, una línea
simple representa a los qubits, mientras que una línea doble indica los bits
clásicos resultantes de la medición.
 
    \begin{figure}[h]
        \centering
        \begin{quantikz}
        \lstick{$\ket{\psi}$} &  \meter{} & \cw{M}
        \end{quantikz}
        \caption{Circuito cuántico representativo para una medición. \textbf{Fuente}: elaboración propia.}
        \label{fig:circuito2}
    \end{figure}



% }}}
\subsection{Plataforma \textit{IBM Quantum Experience}} % {{{

Para este trabajo utilizaremos la plataforma de \textit{IBM Quantum
Experience}. Esta plataforma nos da acceso a computadoras cuánticas para
ejecutar circuitos cuánticos válidos. La conexión a las computadoras se hace
por medio de la librería de qiskit de \textit{Python}.  

Podemos correr circuitos cuánticos en la plataforma por medio de simuladores,
que emulan de forma cercana el comportamiento de una computadora cuántica. Al mismo tiempo podemos correr los circuitos en
computadoras cuánticas reales,  con capacidad de hasta 127 qubits de forma
gratuita \cite{ibm_quantum_resources}. En este trabajo haremos uso de los servicios gratuitos en la
plataforma.  

Al ejecutar un circuito en una computadora cuántica se pasa por un proceso llamado transpilación. Este se encarga de reescribir un circuito cuántico para que se adapte a la topología de un dispositivo cuántico específico. También optimiza sus instrucciones para su ejecución en computadoras cuánticas con presencia de ruido.(ver figura \ref{fig:transpiling}). 
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.20]{imagenes/transpiling_core_steps.png}
    \caption{Proceso de transpilación para un circuito cuántico en la plataforma de IBM \textbf{Fuente}: IBM Quantum API \cite{qiskit_transpiler}.}
    \label{fig:transpiling}
\end{figure}
La topología del sistema influye directamente en como se implementan las interacciones entre qubits dentro del circuito cuántico, especialmente cuando se hacen operaciones entre qubits que no estan conectados de forma uniforme (ver figuras \ref{fig:topos_kyiv} y  \ref{fig:topos}). 

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.7]{imagenes/ibm_kyiv_front.png}
    \caption{Capacidades de la computadora Cuántica IBM\_Kyiv de IBM, con capacidad de 127 qubits. \textbf{Fuente:} IBM Quantum Resources. \cite{ibm_quantum_resources}}
    \label{fig:topos_kyiv}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.5]{imagenes/topo_ibm_kyiv.png}
    \caption{Topología correspondiente a la computadora cuántica IBM\_Kyiv de IBM, con capacidad de 127 qubits. \textbf{Fuente:} IBM Quantum Resources \cite{ibm_quantum_resources}}
    \label{fig:topos}
\end{figure}
\begin{ex} \label{ex:transpilation} \end{ex}
El circuito cuántico mostrado en la figura \ref{fig:circuito7}  se aplica una compuerta $Z$ al qubit $q_3$ , segudo una compuerta $CNOT$ entre los qubits $q_3$ y $q_0$. De forma similar, los qubits $q_2$ y $q_0$ interactúan a través de otra compuerta $CNOT$. Supongamos que buscamos ejecutar este circuito en la computadora cuántica con la topología de la figura \ref{fig:topos}. Ya que los qubits $q_0,q_3$ y $q_0,q_2$ no interaccionan directamente, debemos reescribir nuestro circuito para esta topología. La transpilación resultante se puede ver en la figura \ref{fig:circuito8}).  

\begin{figure}[h]
\centering
\begin{quantikz}
\lstick{$q_0$} & \qw      & \ctrl{3} & \ctrl{2} & \qw \\
\lstick{$q_1$} & \qw      & \qw      & \qw      & \qw \\
\lstick{$q_2$} & \qw      & \qw      & \targ{}  & \qw \\
\lstick{$q_3$} & \gate{Z} & \targ{}  & \qw      & \qw
\end{quantikz}
\caption{Circuito inicial correspondiente al ejemplo \ref{ex:transpilation}. \textbf{Fuente:} elaboración propia.}
\label{fig:circuito7}
\end{figure}


\begin{figure}[h]
\centering
\begin{quantikz}
\lstick{$q_0$} & \qw      & \qw & \qw & \qw & \qw & \qw \\
\lstick{$q_1$} & \gate{H} & \qw      & \qw      & \ctrl{1}  & \gate{H} & \qw\\
\lstick{$q_2$} & \qw      & \ctrl{1}     & \gate{H}  & \targ{} & \gate{H} & \qw\\
\lstick{$q_3$} & \gate{Z} & \targ{}  & \qw      & \qw & \qw & \qw
\end{quantikz}
\caption{Circuito final correspondiente al ejemplo \ref{ex:transpilation}, luego de ser transpilado. \textbf{Fuente:} elaboración propia.}
\label{fig:circuito8}
\end{figure}
La transpilación de circuitos viene incorporada en la librería de Qiskit, es necesaria para ejecutar circuitos en computadoras cuánticas reales y será un componente clave del proyecto. Invitamos al lector a indagar más a detalle en la documentación de la librería \cite{qiskit_transpiler}.



%=================================================
\newpage



% }}}
% }}}
\section{Canales Cuánticos y su representación} % {{{
\label{sec:canales_cuanticos}
Una forma natural de describir la dinámica de un sistema cuántico abierto es considerar que este surge de la interacción de un sistema de interés , al que llamaremos sitema principal , y un \textit{entorno}, que juntos forman un sistema cuántico cerrado \cite{nielsen_chuang_2011}:
\begin{equation}\label{ec:rep_sist_abierto}
    \rho = \rho_{\text{sp}} \otimes \rho_{\text{ent}}.
\end{equation}
Supondremos que la interacción entre ambos sistemas se da por una transformación unitaria $U$, luego de esto, el sistema ya no interactúa con el entorno resultando en el estado final del sistema pincipal $\mathcal{E}$:
\begin{equation}
    \label{ec:sistema_principal}
    \mathcal{E}(\rho_{\text{sp}}) = \text{Tr}_{\text{ent}}[ U( \rho_{\text{sp}} \otimes \rho_{\text{ent}} ) U^\dagger ].
\end{equation}

Notemos que si $U$ no involucra ninguna interacción entre el sistema y el entorno entonces  $\mathcal{E}(\rho_{sp}) =  \widetilde{U} \rho \widetilde{U}^\dagger \footnotemark$\footnotetext{A partir de los siguientes enunciados se utilizará $\rho = \rho_{\text{sp}}$ ya que se entiende de forma implícita que nos referimos a $\rho$ como el sistema principal.} , donde $\widetilde{U}$ es la parte de $U$ que interactúa solo con el sistema principal. 
Este proceso describe cómo los operadores de evolución de sistemas cuánticos cerrados pueden ser generalizados a operadores cuánticos $\mathcal{E}$ (también conocidos como superoperadores), que mapean matrices de densidad del sistema a nuevos estados cuánticos, teniendo en cuenta las influencias del entorno.

Los operadores cuánticos pueden ser representados de forma explícita en términos del espacio de Hilbert de los operadores del sistema principal. Donde $\ket{e_k}$ es una base ortonormal del espacio del entorno, y $\rho_{ent} = \ketbra{e_0}$ su estado inicial, asumimos que:
\begin{align}
\mathcal{E}(\rho) &= \text{Tr}_{\text{ent}}[ U( \rho \otimes \ketbra{e_0} ) U^\dagger ] \\
&= \sum_k E_k \rho E_k^\dagger.  \label{ec:Canal_Kraus}
\end{align}
En esta expresión, cada operador $E_k \equiv \bra{e_k} U \ket{e_0}$ actúa sobre el espacio del sistema principal. Esta formulación es conocida como la representación de Kraus de $\mathcal{E}$. Los operadores $\{E_k\}$ son denominados peradores de Kraus. Además, esta representación caracteriza a $\mathcal{E}$ como un operador completamente positivo (CP).

Los operadores $\{E_k\}$  satisfacen la relación de completitud, que requiere que la traza de $\mathcal{E}(\rho) = 1$:
\begin{align}
    \text{Tr}(\mathcal{E}(\rho)) &= \text{Tr}\left(\sum_k E_k \rho E_k^\dagger\right) \\
    &= \text{Tr}\left(\rho \sum_k E_k^\dagger E_k \right).
\end{align}
Notemos que para que esto se cumpla entonces:
\begin{equation}
    \sum_k E_k^\dagger E_k = I. \label{ec:trace_preserving}
\end{equation}
Esta propiedad caracteriza a los operadores $\mathcal{E}$ que preservan la traza (TP). Por lo tanto, decimos que un canal cuántico $\mathcal{E}$ es un operador completamente positivo y  que preserva la traza (CPTP), cumpliendo con las ecuaciones \ref{ec:Canal_Kraus}  y\ref{ec:trace_preserving}. 

Mientras que la representación de Kraus ofrece una forma de describir los canales cuánticos, la matriz de Choi proporciona una representación alternativa útil para su caracterización. 
La matriz de Choi de un canal cuántico $\mathcal{E}$ se define como \cite{QProcess}:
\begin{equation} 
\Lambda_{\mathcal{E}} = (I \otimes \mathcal{E})(|\Omega\rangle\langle\Omega|),
\end{equation} 
donde $\ket{\Omega}$ es un estado máximamente entrelazado no normalizado $\ket{\Omega} = \sum_i \ket{ii}$ .
Desarrollando el el término $|\Omega\rangle\langle\Omega|$ obtenemos:
\begin{equation}
|\Omega\rangle\langle\Omega| = \sum_{i,j=1}^{d} \ketbra{i}{j} \otimes \ketbra{i}{j},
\end{equation} 
que nos deja la segunda representación de la matriz de Choi
\cite{Qiskit_documentation,QProcess}:
\begin{equation}\label{ec:Choi_ketbra}
\Lambda_{\mathcal{E}} = \sum_{i,j=1}^{d} \ketbra{i}{j} \otimes \mathcal{E}(\ketbra{i}{j}).
\end{equation}
Esta expresión representa la superposición de todas las posibles transformaciones que $\mathcal{E}$ puede aplicar sobre la base computacional del sistema principal luego de su interacción con el entorno. Esto permite ver el efecto del canal sobre cualquier estado del sistema principal.

\begin{ex} \label{Ejemplo 1.0.1} 
\end{ex}
El canal despolarizante  (DP, por sus siglas en inglés de Depolarizing Channel)  es un canal cuántico que introduce ruido aleatorio en un sistema, transformando cualquier estado cuántico de entrada en un estado mixto \cite{nielsen_chuang_2011}. La acción del canal actúa por una probabilidad $p$ de despolarizar un estado cuántico $\rho$ se describe de la forma:
\begin{equation} \label{ec:superop_depolarizing}
\mathcal{E}(\rho) = \text{Tr}(\rho) p  \frac{I}{2}   + (1 - p)\rho ,
\end{equation}
donde $I$ es la matriz identidad y $p$ la probabilidad mencionada. Este canal, por tanto, transforma el estado $\rho$ en una mezcla de $\rho$ y la matriz identidad, reduciendo la pureza del estado inicial. \footnote{La traza de $\rho$ convencionalmente no se muestra en textos como Nielsen y Chuang, sin embargo,  se incluye para asegurar que el canal sea CPTP.}. Dado que el canal  convierte cualquier estado $\rho$ en una mezcla, la acción de $\mathcal{E}$ sobre $\ketbra{i}{j}$ puede escribirse como:
\begin{equation}
\mathcal{E}(\ketbra{i}{j}) = \text{Tr}(\ketbra{i}{j})  p \frac{I}{2}+ (1 - p) \ketbra{i}{j}.
\end{equation}
Por lo lo tanto, podemos ver su acción en los estados de la base:
\begin{alignat*}{2}
     \mathcal{E}( \ketbra{0}) = & (1 - \frac{p}{2} ) \ketbra{0} + \frac{p}{2} \ketbra{1}, \\
     \mathcal{E}( \ketbra{0}{1}) = & (1 - p ) \ketbra{0}{1},\\
      \mathcal{E}( \ketbra{1}{0}) = & (1 - p ) \ketbra{1}{0},\\
           \mathcal{E}( \ketbra{1}) = & (1 - \frac{p}{2} ) \ketbra{1} + \frac{p}{2} \ketbra{0}.
\end{alignat*}
Recordando la ecuación \ref{ec:Choi_ketbra}, escribimos su matriz de Choi:
% \begin{equation}
% \Lambda_{\mathcal{E}} = \frac{1}{2} \sum_{i,j=0}^{1} \ketbra{i}{j} \otimes \left(  \text{Tr}(\ketbra{i}{j} ) p  \frac{I}{2} +  (1-p) \ketbra{i}{j}  \right).
% \end{equation}
% que consiguientemente nos da la matriz 
\begin{equation}\label{ec:choi_depolarizing}
    \Lambda_\mathcal{E} = 
\begin{pmatrix}
1 - \frac{p}{2} & 0 & 0 & 1 - p \\
0 & \frac{p}{2} & 0 & 0 \\
0 & 0 & \frac{p}{2} & 0 \\
1 - p & 0 & 0 & 1 - \frac{p}{2}
\end{pmatrix}.
\end{equation}
Notemos cómo $\Lambda_{\mathcal{E}}$ refleja el funcionamiento del canal despolarizante: las entradas diagonales muestran cómo el canal mezcla el estado original con la matriz identidad, dependiendo de $p$, reduciendo la pureza del estado. Las entradas no diagonales indican las coherencias introducidas por el canal.


La matriz de Choi tiene  varias propiedades descritas en el paper de  G. Homa  y otros \cite{Choi2024},  que permiten describir completamente un canal cuántico y hacer una correlación con la representación de Kraus:
\begin{enumerate}
     \item Para un operador $\mathcal{E}$ completamente positivo, dado en una representación de Kraus, su matriz de Choi es \textit{Hermítica}, es decir $\Lambda_{\mathcal{E}} = \Lambda_{\mathcal{E}}^{\dagger}$.\\ 
        La transpuesta conjuntada de la matriz de Choi es: 
        \begin{equation*}
            \Lambda_{\mathcal{E}}^\dagger = \left( \sum_{i,j} \ketbra{i}{j} \otimes \mathcal{E}(\ketbra{i}{j}) \right)^\dagger.
        \end{equation*}
        Utilizando la propiedad de la transpuesta conjuntada $(A \otimes B)^\dagger = A^\dagger \otimes B^\dagger$, obtenemos:
        \begin{equation}
          \Lambda_{\mathcal{E}}^\dagger = \sum_{i,j} (\ketbra{i}{j})^\dagger \otimes \mathcal{E}(\ketbra{i}{j})^\dagger.  
        \end{equation}
        Sabemos que $(\ketbra{i}{j})^\dagger = \ketbra{j}{i}$ y que $\mathcal{E}(\ketbra{i}{j})^\dagger = \mathcal{E}(\ketbra{j}{i})$ porque $\mathcal{E}$ es un operador CP. Así, tenemos:
        \begin{equation}
         \Lambda_{\mathcal{E}}^\dagger = \sum_{i,j} \ketbra{j}{i} \otimes \mathcal{E}(\ketbra{j}{i}).   
        \end{equation}
        Cambiando los índices de suma, podemos renombrar $i$ como $j$ y $j$ como $i$:
        \begin{equation}
           \Lambda_{\mathcal{E}}^\dagger = \sum_{j,i} \ketbra{i}{j} \otimes \mathcal{E}(\ketbra{i}{j}) = \Lambda_{\mathcal{E}}. \blacksquare
        \end{equation}
    \item Para un operador $\mathcal{E}$ completamente positivo, podemos escribirlo en términos de la matriz de Choi como:
            \begin{equation}\label{ec:canal_choi_form}
            \mathcal{E} (\rho) = \text{Tr}_1 [ \Lambda ( \rho^{T} \otimes I)] .
            \end{equation}
            Para demostrar esta expresión partimos de escribir a  $\rho$ en la base computacional:
        \begin{equation} \label{ec:densidad_computacional}
            \rho = \sum_{k,l} \rho_{k,l} \ketbra{k}{l},
        \end{equation}
        entonces:
        \begin{equation}
            \rho^{T} \otimes I = \sum_{k,l} \rho_{k,l} \ketbra{l}{k} \otimes I.
        \end{equation}
        Multiplicamos $\Lambda$ con $\rho^{T} \otimes I$:
        \begin{align}
            \Lambda(\rho^{T} \otimes I) & = \left( \sum_{i,j} \ketbra{i}{j} \otimes \mathcal{E}(\ketbra{i}{j}) \right) \left( \sum_{k,l} \rho_{k,l} \ketbra{l}{k} \otimes I \right) \\
            & = \sum_{i,j,k,l} \rho_{k,l} (  \ketbra{i}{j} ) (\ketbra{l}{k}) \otimes \mathcal{E} (\ketbra{i}{j})\\
            & =  \sum_{i,j,k,l} \rho_{k,l} \delta_{j,l} \ketbra{i}{k} \otimes \mathcal{E}( \ketbra{i}{j})\\
            & = \sum_{i,k,l} \rho_{k,l} \ketbra{i}{k} \otimes \mathcal{E}( \ketbra{i}{l}).
        \end{align}
        Si trazamos parcialmente el primer subsistema tenemos la expresión: 
        \begin{equation}
            \text{Tr}_1 [ \Lambda ( \rho^{T} \otimes I)]  = \text{Tr}_1 \left[  \sum_{i,k,l} \rho_{k,l}\ketbra{i}{k} \otimes \mathcal{E}(\ketbra{i}{l})\right],
        \end{equation}
        consideramos solo los términos donde $i=k$:
        \begin{equation}
            \text{Tr}_1 [ \Lambda ( \rho^{T} \otimes I)]  = \sum_{i,l}\rho_{i,l} \mathcal{E}(\ketbra{i}{l}) = \mathcal{E}(\rho) .\blacksquare
        \end{equation}
        Notemos también  que podemos reescribir esta expresión en términos de los operadores de Kraus:
        \begin{equation}
            \mathcal{E}(\rho) = \sum_{i,l} \rho_{i,l} \sum_k E_k \ketbra{i}{l}E_k^{\dagger},
        \end{equation}
        ya que $\rho_{i,l}$ es un escalar, y recordando la ecuación \ref{ec:densidad_computacional}, reordenamos la expresión: 
        \begin{align}
            \mathcal{E}(\rho)& = \sum_k E_k \left( \sum_{i,l}\rho_{i,l}\ketbra{i}{l}\right) E_k^{\dagger}\\
            & = \sum_k E_k \rho E_k^{\dagger}.
        \end{align}


        
    \item La matriz de Choi $\Lambda_{\mathcal{E}}$ de un mapeo completamente positivo (CP), es positivo semidefinido (no negativo).\\ 
     Tomemos cualquier estado $\ket{\psi}$:
    \begin{equation}
    \bra{\psi} \Lambda_{\mathcal{E}} \ket{\psi} = \bra{\psi} (\mathcal{I} \otimes \mathcal{E})(\ketbra{\Omega}) \ket{\psi}.
    \end{equation}
    
    Si escribimos a $\ket{\psi} = \sum_i c_i \ket{i} \otimes \ket{\psi_i}$, tenemos:
    \begin{equation}
    \bra{\psi} \Lambda_{\mathcal{E}} \ket{\psi} = \sum_{i,j} \overline{c_i} c_j \bra{\psi_i} \mathcal{E}\ketbra{i}{j}) \ket{\psi_j}.
    \end{equation}
    Debido a que $\mathcal{E}$ es completamente positivo, entonces $\mathcal{E}(\ketbra{i}{j})$ es un operador positivo semidefinido. Por lo tanto: 
    \begin{equation}
    \bra{\psi_i} \mathcal{E}(\ketbra{i}{j}) \ket{\psi_j} \geq 0,
    \end{equation}
    que sumando sobre todos los índices $i$ y $j$, obtenemos que
    \begin{equation}
    \bra{\psi} \Lambda_{\mathcal{E}} \ket{\psi} \geq 0. \blacksquare
    \end{equation}
    \item Sea $\Lambda \geq0$ una matriz hermitica de dimensión $d \times d$. Es la representación de Choi de un de un mapeo que preserva la traza (TP) sí y solo sí 
    \begin{equation}
        \text{Tr}_2 (\Lambda) = I.
    \end{equation}
    \textbf{Ida:} suponemos que $\mathcal{F}$ es un mapeo que preserva la traza. Por lo que si trazamos parcialmente el segundo subsistema tenemos:
    \begin{equation}
        \text{Tr}_2(\Lambda) = \sum_{i,j}\ketbra{i}{j}\text{Tr}( \mathcal{F}(\ketbra{i}{j})),
    \end{equation}
    ya que $\mathcal{F}$ preserva la traza, entonces $\text{Tr}( \mathcal{F}(\ketbra{i}{j})) = Tr(\ketbra{i}{j})$, por lo tanto:
    \begin{equation}
         \text{Tr}_2(\Lambda) = \sum_{i,j}\ketbra{i}{j} \delta_{ij}= \sum_i \ketbra{i}= I. 
    \end{equation}
    
    \textbf{Vuelta:} suponemos que $\text{Tr}_2(\Lambda) = I$ para $\Lambda$. Por lo que si usamos la representación del mapeo $\mathcal{F}$ según la ecuación \ref{ec:canal_choi_form} tenemos:
    \begin{align}
        \text{Tr} (\mathcal{F}(\rho)) &= \text{Tr}( \text{Tr}_1 [ \Lambda ( \rho^{T} \otimes I)]).
    \end{align}
    Usando la propiedad cíclica de la traza $\text{Tr}(AB) = \text{Tr}(BA)$:
    \begin{align}
        &= \text{Tr}[(\rho^T \otimes I) \Lambda], \\
        &= \text{Tr}[\rho^T \cdot \text{Tr}_2(\Lambda)]\\
        &= \text{Tr}(\rho^T)\\
        &=\text{Tr}(\rho).
    \end{align}
    Por lo tanto, vemos que $\text{Tr}(\mathcal{F}(\rho))= \text{Tr}(\rho)$, esto muestra que $\mathcal{F}$ preserva la traza $\blacksquare$.

    \item La matriz de Choi $\Lambda_{\mathcal{E}}$ de un operador cuántico completamente positivo y que preserva la traza (CPTP)  es única. \\
    Supongamos dos operadores distintos $\mathcal{F}$ y $\mathcal{G}$ con la misma matriz de Choi:
    \begin{equation}
       \sum_{i,j=1}^{d} \ketbra{i}{j} \otimes \mathcal{F}(\ketbra{i}{j}) =  \sum_{i,j=1}^{d} \ketbra{i}{j} \otimes \mathcal{G}(\ketbra{i}{j}).
    \end{equation}
    Esto implica que para cada par $i, j$, se debe cumplir que $\mathcal{F}(\ketbra{i}{j}) = \mathcal{G}(\ketbra{i}{j})$. Dado que los elementos $\ketbra{i}{j}$ abarcan toda la base del espacio de operadores, implica que $\mathcal{F} = \mathcal{G}$ para todos los posibles estados en el espacio $\blacksquare$.
\end{enumerate}

Tras demostrar estas propiedades, es importante establecer una diferencia fundamental entre la representación de Choi y la de Kraus: la representación de Choi es única para un canal cuántico $\mathcal{E}$. Esta demostración se da por el Teorema 8.1 en Nielsen y Chuang \cite{nielsen_chuang_2011}: 

\begin{thm}\textbf{(Teorema de libertad unitaria en la representación de Kraus):}  Supongamos dos conjuntos de operadores de Kraus $\{E_i, \ldots, E_m\}$ y $\{F_1, \ldots, F_r\}$ que representan el mismo canal cuántico. Podemos asegurar que $m = n$ añadiendo ceros a la lista más corta de operadores. Entonces, $\{E_i\}$ y $\{F_j\}$ describen el mismo canal cuántico si y solo si existe una matriz unitaria $U$ tal que $E_i = \sum_j u_{ij} F_j$, donde $u_{ij}$ es un elemento de la matriz unitaria $U$.
\end{thm}

Para probar este teorema partimos sabiendo que  $\{E_i\}$ y $\{F_j\}$ son conjuntos de operadores de Kraus para el mismo canal cuántico, tenemos que:
\begin{equation}
   \sum_i E_i^\dagger E_i = \sum_j F_j^\dagger F_j. 
\end{equation}
Definimos los estados $\ket{e_i} = E_i \ket{k}$ , $\ket{f_j} = F_j \ket{k}$. Por la definición de un operador de Kraus, podemos escribir:
\begin{equation}
  \ket{e_i} = \sum_j u_{ij} \ket{f_j},  
\end{equation} 
donde $u_{ij}$ son los elementos de una matriz unitaria $U$.\\
Por otro lado, cualquier estado $\ket{\psi}$ puede expresarse en términos de $\ket{e_i}$ y $\ket{f_j}$ de la siguiente forma:
\begin{equation}
E_i \ket{\psi} = \sum_j u_{ij} F_j \ket{\psi}.
\end{equation}
Esto demuestra que $E_i$ puede ser expresado como una combinación lineal de $\{F_j\}$ con coeficientes unitarios, mostrando que la representación de Kraus no es única y depende de la elección de la matriz unitaria $U$. $\blacksquare$

Por lo tanto, en adelante utilizaremos la notación de la matriz de Choi, ya que nos será de utilidad para la reconstrucción de canales cuánticos en la tomografía de proceso y la fidelidad de proceso al ejecutarlo en computadoras cuánticas.



\subsection{Tomografía de Proceso Cuántico} % {{{
\label{sec:Tomo_proc}
La tomografía de proceso cuántico (QPT) es una técnica fundamental para reconstruir experimentalmente un canal cuántico por medio de mediciones. Sin embargo, antes es necesario conocer la tomografía de estado cuántico.  


La tomografía de estado cuántico es un proceso para reconstruir
experimentalmente un estado desconocido a partir de un conjunto de mediciones
\cite{nielsen_chuang_2011}. Es posible estimar $\rho$ si tenemos un gran número de copias del mismo. Mencionaremos el proceso
indicado en el libro de Nielsen y Chuang \cite{nielsen_chuang_2011}:
\begin{quote}
Consideremos un estado $\rho$ y los operadores $\{\frac{\mathcal{I}}{\sqrt{2}}
\frac{X}{\sqrt{2}},  \frac{Y}{\sqrt{2}},  \frac{Z}{\sqrt{2}} \} $ que forman un
conjunto ortonormal de matrices con su respectivo producto interno. Entonces,
$\rho$ se expande como:
\begin{equation}
\label{eq:tomo_estado}
    \rho = \frac{\text{Tr}(\rho)\mathcal{I} + \text{Tr}(X\rho)X  + \text{Tr}(Y\rho)Y + \text{Tr}(Z\rho)Z}  {2}.
\end{equation}
La expresión $\text{Tr}(A\rho)$ se interpreta como el valor medio de los observables. Para esta estimación, si medimos un observable $A$ una gran cantidad de veces, $m$, obteniendo resultados $z_i$ iguales a $\pm 1$, nuestro promedio empírico de resultados sería:
\begin{equation}
    \text{Tr}(A \rho) \approx \sum_i \frac{z_i}{m}.
\end{equation}
De esta forma podemos reconstruir la matriz $\rho$ como en la ecuación \ref{eq:tomo_estado}.  

Generalizando este procedimiento, para el caso de una matriz densidad arbitraria de $n$ qubits, puede ser expandida cómo:
\begin{equation}
\rho = \sum_{\vec{v}} \frac{ \text{Tr}(\sigma_{v_1} \otimes \sigma_{v_2} \otimes ... \otimes \sigma_{v_n} \rho  ) \sigma_{v_1} \otimes \sigma_{v_2 } \otimes ... \otimes \sigma_{v_n}     }{2}.
\end{equation}
\end{quote}
La suma de la ecuación es sobre vectores $\vec{v} = (v_1,...,v_n)$ con entradas $v_i$ escogidas del conjunto 0,1,2,3. Al realizar mediciones de observables que son productos de las matrices de Pauli, podemos estimar cada término en esta suma, y entonces estimar $\rho$. 

Para implementar la tomografía de estado en una computadora cuántica es
necesario realizar mediciones en las bases de los operadores de Pauli
$(X,Y,Z)$. Por ello, podemos hacer un cambio de base para nuestras mediciones. Por lo tanto, para $X$ transformamos a los estados de la base $\{ 
 {\ket{0},\ket{1}} \}$, a la base de Pauli $X$:
\begin{equation}
    \ket{\pm} = \frac{1}{\sqrt{2}} (\ket{0} \pm \ket{1}),
\end{equation}
por medio de la compuerta de Hadamard $H$. 
Por el lado de $Y$, se transforma el estado por medio de la compuertas $H$, seguido de la compuerta $S^{\dagger}$, que es una rotación $R_z(-\pi/2)$ alrededor de la esfera de Bloch, dando como resultado el cambio a la base:
\begin{equation}
 \ket{\pm i} = \frac{1}{\sqrt{2}}(\ket{0} \pm i\ket{1}).
\end{equation}
Por ende, el circuito cuántico debe ser medido en cada una de las bases (ver figura \ref{eq:circuitos_tomoestado})  un número $m$ de veces para reconstruir el estado $\rho$.

  \begin{figure}[h]
        \centering
        \begin{quantikz}
        \lstick{$\ket{\psi}$} &  \gate{X} & \meter{} & \cw{M}
        \end{quantikz},
        \begin{quantikz}
        \lstick{$\ket{\psi}$} &  \gate{H} & \gate{S^{\dagger}} & \meter{} & \cw{M}
        \end{quantikz} , 
        \begin{quantikz}
        \lstick{$\ket{\psi}$}  & \meter{} & \cw{M}
        \end{quantikz}  
        \caption{Mediciones cuánticas necesarias para realizar la tomografía de estado. \textbf{Fuente:} elaboración propia.}
        \label{eq:circuitos_tomoestado}
    \end{figure}

La tomografía de proceso implica preparar un conjunto de estados puros de entrada que forman una base del espacio de matrices $\ket{\psi_j}$. Estos estados interactúan con el canal cuántico $\mathcal{E}$, y luego se realiza la tomografía de estado cuántico para reconstruir $\mathcal{E}(\ketbra{\psi_j}{\psi_j})$. Nuevamente, mencionamos esta elección de estados usado en Nielsen y Chuang \cite{nielsen_chuang_2011}: 
\begin{quote}
Sea $\rho_j$ , $1\leq j \leq d^2$ una base linealmente independiente del espacio de matrices $d\times d$, es decir, que cualquier matriz $d \times d$ puede ser escrita como una combinación linear única de $\rho_j$.  Una elección conveniente de operadores es $\ketbra{n}{m}$. Por lo tanto, los estados de salida $\mathcal{E}(\ketbra{n}{m})$ pueden ser considerados preparando los estados de entrada:
\begin{itemize}
    \item$\ket{n}$,
    \item$\ket{m}$,
    \item$\ket{+} = \frac{\ket{n} + \ket{m}}{\sqrt{2}}$,
    \item$\ket{-} = \frac{\ket{n} + i\ket{m}}{\sqrt{2}}$.
\end{itemize}
Luego se forman combinaciones lineales de $\mathcal{E} (\ketbra{n}), \ketbra{m},\mathcal{E}(\ketbra{+})$ y $\mathcal{E}(\ketbra{-})$ de la forma:
\begin{equation}
    \mathcal{E}(\ket{n}\bra{m}) = \mathcal{E}(\ket{+}\bra{+}) + i \mathcal{E}(\ket{-}\bra{-}) - \frac{1 + i}{2} \mathcal{E}(\ket{n}\bra{n}) - \frac{1 + i}{2} \mathcal{E}(\ket{m}\bra{m}).
\end{equation}
Entonces, es posible determinar $\mathcal{E}(\rho_j)$ por medio de tomografía de estado para cada $\rho_j$.
\end{quote}

Qiskit , para un qubit , utiliza los estados de entrada para la QPT:
\begin{alignat}{2}
    \ket{\psi_1} &= \ket{0}, \\
    \ket{\psi_2} &= \ket{1}, \\
    \ket{\psi_3} &= \ket{+} &&= \frac{1}{\sqrt{2}}(\ket{0} + \ket{1}), \\
    \ket{\psi_4} &= \ket{i} &&= \frac{1}{\sqrt{2}}(\ket{0} + i\ket{1}).
\end{alignat}
Notemos que para la matriz de Choi necesitamos los estados $\ketbra{0}{1}$ y $\ketbra{1}{0}$, que obtenemos respectivamente:
\begin{alignat}{1}
    \ketbra{0}{1} &= \frac{1}{2} \left( \ketbra{+}{+} - \ketbra{-}{-} + i \big( \ketbra{i}{i} - \ketbra{-i}{-i} \big) \right), \\
    \ketbra{1}{0} &= \frac{1}{2} \left( \ketbra{+}{+} - \ketbra{-}{-} - i \big( \ketbra{i}{i} - \ketbra{-i}{-i} \big) \right).
\end{alignat}
Con cada estado reconstruido $\mathcal{E}(\ketbra{\psi_i})$,  obtenemos la matriz de Choi $\Lambda_{\mathcal{E}}$ ( \ref{ec:Choi_ketbra} ). De esta forma, la tomografía de proceso cuántico proporciona una descripción completa y detallada del canal cuántico por medio de mediciones. 

% }}}
\subsection{Fidelidad de Proceso Cuántico} % {{{
Previo a hablar de la fidelidad de proceso cuántico es necesario conocer la
fidelidad de estado cuántico, que es una una forma de conocer la similitud
entre dos estados cuánticos. Si poseemos dos estados $\rho,\sigma$, conoceremos
su fidelidad por la ecuación \cite{nielsen_chuang_2011,bengtsson_zyczkowski_2017}:
\begin{equation}
       \label{eq:fidelidad_estado}
       F(\rho,\sigma) \equiv tr \sqrt{\rho^{1/2} \sigma \rho^{1/2} } = tr |\sqrt{\rho}\sqrt{\sigma}|.     \footnote{La ecuación usada aquí para describir la fidelidad es la descrita en Nielsen y Chuang. En otros textos,  como del autor original Richard Jozsa\cite{Jozsa} y Bengston \cite{bengtsson_zyczkowski_2017},  suelen llamarla  'raíz fidelidad'.}
\end{equation}  

    
Es importante mencionar las propiedades que conforman a la fidelidad de
estados. Previo a ello mencionaremos un teorema importante mencionado
originalmente en el artículo de Jozsa \cite{Jozsa} y luego reescrito en Nielsen
y Chuang  \cite{nielsen_chuang_2011}, que da sentido a la ecuación
(\ref{eq:fidelidad_estado}):
    
    \begin{thm}
    \textbf{(Teorema de Uhlmann)}: $F(\rho,\sigma) = max |\braket{\psi_\rho}{\psi_\sigma}|$ . El máximo se toma sobre las purificaciones de $\ket{\psi_\rho}$ y $\ket{\psi_\sigma}$ de $\rho,\sigma$ respectivamente. 
    \end{thm}
     Para probar este teorema supondremos dos estados $\ket{\psi_\rho},\ket{\psi_\sigma}$ que son las purificaciones de las matrices $\rho,\sigma$ respectivamente. Si los escribimos de forma general tendremos:
    \begin{align}
        \ket{\psi_\rho} & = \sum_k \sqrt{\lambda_k} \ket{\lambda_k u_k},\\
        \ket{\psi_\sigma} & = \sum_k \sqrt{\mu_k} \ket{\mu_k v_k},       
    \end{align}
    siendo $\ket{\lambda_k},\ket{\mu_k}$ autovectores de $\rho,\sigma$, y $\{\ket{u_k} \}_k, \{\ket{v_k} \}_k$ bases ortonormales arbitarias. Al superponer las purificaciones obtenemos:
    \begin{align}
        \braket{\psi_\rho}{\psi_\sigma} & = \sum_{jk} \sqrt{\lambda_j\mu_k} \braket{\lambda_j}{\mu_k} \braket{u_j}{v_k},
    \end{align}
    con $\text{Tr}(A) = \sum_{i=1}^{d} \lambda_i$, siendo $\lambda_i$ sus autovalores llegamos a la expresión:
    \begin{equation}
    \label{eq:rho_ij0}
        \braket{\psi_\rho}{\psi_\sigma} = \text{Tr}( \sqrt{\rho}\sqrt{\sigma} U ),
    \end{equation}
    con la matriz unitaria $U$ definida como:
    \begin{equation}
        U = \left(\sum_k \ketbra{\mu_k}{u_k}    \right)  \left(\sum_j \ketbra{v_j} {\lambda_j}   \right) .
    \end{equation} 
    En este momento es bueno introducir el siguiente lema de Nielsen y Chuang \cite{nielsen_chuang_2011} que dice lo siguiente:
    \begin{lem}  Sea A cualquier operador, y $U$ unitario. Entonces
    \begin{equation}
        | \text{Tr}(AU)| \leq tr|A|,
    \end{equation}
    con la igualdad obtenida escogiendo $U= V^\dagger$. Aquí $A= |A|V$ es la descomposición polar de $A$.
    \end{lem}
    Para probar este lema podemos ver que:
    \begin{equation}
        |\text{Tr}(AU)| = |\text{Tr}(|A|VU)| = \left| \text{Tr}(|A|VU  ) \right| = \left|\text{Tr}(|A|^{1/2}|A|^{1/2} VU )   \right|.
    \end{equation}
    Usando la desigualdad de Cauchy-Schwarz \cite{nielsen_chuang_2011} para el espacio de Hilbert-Schmidt obtenemos:
    \begin{equation}
        |\text{Tr}(AU)| \leq \sqrt{ tr|A| \text{Tr}(U^\dagger V^ \dagger  |A|VU) } = tr|A| \blacksquare  
    \end{equation} 
    Retomando la prueba de Uhlman, al usar el (Lema 9.5 ) comparado con la ecuación ( \ref{eq:rho_ij0})  llegamos a la conclusión
    \begin{equation}
        |\braket{\psi_\rho}{\psi_\sigma}| = |\text{Tr}(\sqrt{\rho} \sqrt{\sigma} U )| \leq tr|\sqrt{\rho} \sqrt{\sigma} |.
    \end{equation}
    Esto nos quiere decir que $|\braket{\psi_\rho}{\psi_\sigma}| = tr| \sqrt{\rho}\sqrt{\sigma}|$ cuando las purificaciones $\ket{\psi_\rho}$ y $\ket{\psi_\sigma}$ son tales que $\sqrt{\rho}\sqrt{\sigma} U = |\sqrt{\rho}\sqrt{\sigma}|$. Como esta selección no depende de los estados que escojamos podemos concluir que
    \begin{equation}
        tr|\sqrt{\rho}\sqrt{\sigma}| = max | \braket{\psi_\rho}{\psi_\sigma}|. \blacksquare
    \end{equation}
    Consecuencia del teorema anterior se tienen las siguientes propiedades de la fidelidad mostradas en el paper de Josza \cite{Jozsa}:
    \begin{enumerate}
        \item La fidelidad posee valores acotados. $0 \leq F(\rho,\sigma) \leq 1$ y también $F(\rho,\sigma)=1 $ sí y solo sí $\rho=\sigma$.
	\item La fidelidad es simétrica, es decir  $F(\rho,\sigma) = F(\sigma,\rho).$
        \item Si $\rho= \ketbra{\Omega}{\Omega}$ es puro, entonces $F(\rho,\sigma)= \sqrt{\bra{\Omega}\sigma \ket{\Omega}} = \text{Tr}(\sqrt{\rho} \sqrt{\sigma}).$
    \end{enumerate}

    
Ya que conocemos la fidelidad de estado cuántico, podemos calcular la similitud entre dos canales cuánticos por medio de la  fidelidad de proceso $F_{\text{proc}}$ entre dos canales cuánticos $\mathcal{E}$ y $\mathcal{F}$. Esta se define como:
\begin{equation} \label{ec:fidel_proc}
F_{\text{proc}}(\mathcal{E}, \mathcal{F}) = F(\rho_{\mathcal{E}}, \rho_{\mathcal{F}}), 
\end{equation}
donde $F$ es la fidelidad de estado,  $\rho_{\mathcal{E}} =  \Lambda_{\mathcal{E}}/d $ es la matriz de Choi normalizada del canal cuántico $\mathcal{E}$, y $d$ es la dimensión de entrada del canal $\mathcal{E}$. 

Esta métrica proporciona una medida cuantitativa de cuán similar es un canal cuántico experimental al canal cuántico teórico. Ya que utiliza la fidelidad de estado, mantiene las mismas propiedades para describir a los canales cuánticos. 

% }}}
% }}}
% }}}
\chapter{ALGORITMOS VARIACIONALES CUÁNTICOS (VQA)} % {{{
\label{cap:algoritmos_variacionales}
% \section{Introducción} % {{{
La llegada de la tecnología ruidosa de escala intermedia (NISQ) ha generado
gran interés, ya que permite trabajar con una mayor cantidad de qubits, aunque
también con mayores niveles de error. Por ello, es fundamental implementar
algoritmos que aprovechen las capacidades del hardware actual. Uno de ellos
son los algoritmos variacionales cuánticos (VQA), los cuales serán
desarrollados en la sección~\ref{sec:desc_vqa}, ya que funcionan de forma
híbrida cuántico-clásica optimizando circuitos parametrizados para resolver
una tarea específica.

Con este desarrollo general, en la sección~\ref{sec:impl_vqa} se propone una
aplicación del VQA utilizando un \textit{Hardware Efficient Ansatz} (HEA) para
la implementación de canales cuánticos de un qubit en una computadora cuántica.
Finalmente, en esa misma sección, se presenta un ejemplo concreto en el que se
emplea un HEA para implementar un canal despolarizante haciendo uso del VQA. Al
finalizar este capítulo, se habrán establecido las bases necesarias para
implementar un canal cuántico de un qubit en la plataforma IBM Quantum
Experience mediante este tipo de algoritmos.

% }}}
\section{Descripción de los VQA} \label{sec:desc_vqa} % {{{
%==================================
Los VQA son algoritmos que entrenan a un circuito cuántico parametrizado
$U(\bm{\theta})$ que luego es optimizado de forma clásica para resolver una
tarea dada. Es importante establecer una definición formal, por ello usaremos
la definición mencionada en el paper de Lorenzo Leone y otros~\cite{HEA}:
\begin{quote}
\enquote{Sea $O$ un operador Hermítico, cuyo estado fundamental codifique la solución de un problema de interés. En una tarea VQA, el objetivo es minimizar una función de costo $C(\bm{\theta})$, parametrizada a través de un circuito cuántico $U(\bm{\theta})$, para preparar el estado fundamental de $O$ a partir de un estado fiduciario $\ket{\psi_0}$.}
\end{quote}
En una tarea VQA usualmente se define una función de costo de la forma:
\begin{equation}
    C(\bm{\theta}) =  \text{Tr} \left[U(\bm{\theta}) \ketbra{\psi_0}{\psi_0} U^{\dagger}(\bm{\theta}) O \right],
\end{equation}
donde $\bm{\theta}$ es un conjunto de parámetros $ \bm{\theta}= (\theta_0,\theta_1,...,\theta_n)$. 
El valor de $C(\bm{\theta})$ se obtiene a través de mediciones en la computadora cuántica, posteriormente se usa un algoritmo de optimización clásica para encontrar los parámetros óptimos $\theta^*$ de la forma:
\begin{equation}
\theta^* = \text{arg }\underset{\bm{\theta}} {\text{min}} C (\bm{\theta}).
\end{equation}

El aspecto más importante de los VQA es la elección del ansatz, que se refiere a las especificaciones para el arreglo y tipo de compuertas cuánticas en $U(\bm{\theta})$ (ver figura \ref{fig:ansatz_general}). El ansatz más comunmente usado es el \textit{Hardware Efficient-Ansatz} (HEA) cuyo objetivo principal es mitigar el efecto del ruido del hardware usando compuertas nativas del dispositivo específico que se esté usando.

La ventaja principal de los HEA es que están diseñados para minimizar la profundidad del circuito, que reduce los efectos adversos del ruido del hardware cuántico \cite{HEA}. Además, su diseño es independiente de la tarea a resolver, lo cual los hace más versátiles y aplicables a una variedad de problemas sin ajustes específicos.
Generalmente asumimos que el circuito cuántico parametrizado se expresa cómo: 
\begin{equation}
    U(\bm{\theta}) = \prod\limits_{l} e^{-i\theta_lH_l} V_l.
\end{equation}
donde $\{V_l\}$ son operadores unitarios no parametrizados y $\{H_l\}$ son operadores de Pauli sin traza.
En este trabajo consideraremos la instancia más profunda y eficiente que es el HEA alternador de capas unidimensional. Aquí se asume que los qubits físicos en el hardware están organizados en una cadena como lo vimos en la topología de las computadoras cuánticas de IBM en la figura \ref{fig:topos}. 
Posteriormente, cada capa $L$ del circuito conecta cada qubit con su vecino cercano de forma alterna, similar a un ladrillo (ver figura \ref{fig:HEA_ansatz}).  
\begin{figure}[h!]  
    \begin{subfigure}[b]{0.47\linewidth}
        \includegraphics[width=\linewidth]{imagenes/ansatz_esquema.jpg}
        \caption{}
        \label{fig:ansatz_general}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.55\linewidth}
        \includegraphics[width=\linewidth]{imagenes/HEA_ansatz.jpg}
        \caption{}
        \label{fig:HEA_ansatz}
    \end{subfigure}
    \caption{(a) Diagrama esquemático de un ansatz, donde el operador unitario $U(\bm{\theta})$ puede ser expresado como el producto de $L$ unitarias $U_l(\theta_l)$ de forma secuencial actuando sobre un estado inicial. \textbf{Fuente}: M. Cerezo y otros \cite{VQA}. (b) Diagrama esquemático de un HEA donde se nota cómo este usa compuertas de dos qubits organizadas en forma de ladrillo. \textbf{Fuente}: Lorenzo Leone y otros \cite{HEA}.}
    \label{fig:ansatz_comparacion}
\end{figure}
% }}}
\section{Implementación de canales de un qubit usando VQA}\label{sec:impl_vqa}  % {{{
Podemos iniciar un canal cuántico en una computadora cuántica si conocemos el conjunto de compuertas específicas que repliquen la acción del canal sobre el sistema principal $\rho$. Por ello hemos propuesto utilizar los VQA para inicializar canales cuánticos de un qubit. Para esto nuestra función de costo a optimizar será la fidelidad de proceso, ver ecuación \ref{ec:fidel_proc}:
\begin{equation}
    \label{ec:cost_func}
    C(\bm{\theta}) = \frac{1}{d^2} F_{proc}\bigl( \Lambda_r(\bm{\theta}), \Lambda_{obj} \bigr),
\end{equation}
 donde $\Lambda_r$ es la matriz de Choi reconstruida tras realizar la
tomografía de proceso sobre el circuito cuántico parametrizado, mientras que
$\Lambda_{obj}$ es la matriz de Choi objetivo del canal cuántico a implementar.
 
Por otro lado, el HEA utilizado para este proyecto es el mismo usado en el
paper de Huan-Yu Liu y otros \cite{Liu_2021,Sim_2019}, que combina
compuertas sencillas de implementar entre operaciones de uno o dos qubits.
Luego las capas son repetidas para incrementar la profundidad expresiva, por
lo que la estructura del ansatz es:
 \begin{equation}
 \label{ec:ansatz}
     U(\bm{\theta}) =\prod_{i=1}^{M} \prod_{j=1}^N U_{ent} (\theta_i)R_z(\theta_{ij})R_x(\theta_{ij2})R_z(\theta_{ij3}),
 \end{equation}
donde $N$ y $M$ son el número de qubits y capas en el circuito respectivamente.
Para la parte de entrelazamiento $U_{ent}$ tomamos compuertas de control
$cR_y$.  En este esquema, los parámetros $\bm{\theta}$ corresponden a los
ángulos de rotación de las compuertas del ansatz. Este circuito puede
interpretarse como un modelo de sistema abierto, donde el sistema principal
interactúa con un entorno, como se muestra en la
ecuación~\ref{ec:rep_sist_abierto}.
% Podemos ver a este circuito cuántico como un
% sistema cerrado en la ecuación \ref{ec:rep_sist_abierto}, donde el sistema
% principal se obtiene luego de interactuar con el entorno como en la ecuación
% \ref{ec:sistema_principal}
Aquí quiero decir que este ansatz representa el sistema como $\rho_{sp} \otimes
\rho_{ent}$ ( $\rho_{sp}$ es el sistema principal) . Lo menciono para darle
sentido a la ecuación  (\ref{ec:tr_anc}).  Notemos que este ansatz construye un
estado puro de  $2n$ qubits de la forma:
\begin{equation} 
    \ket{\psi(\bm{\theta})} = U(\bm{\theta})\ket{0}^{\otimes 2n}.
\end{equation}
%======================
Posteriormente, se realiza la traza parcial sobre los $n$ qubits auxiliares con el fin de obtener el estado del sistema principal:
\begin{equation} \label{ec:tr_anc}    \text{Tr}_{\text{anc}}\left[\ketbra{\psi(\bm{\theta})}{\psi(\bm{\theta})}\right] = \rho(\bm{\theta}),
\end{equation}
donde $\rho(\bm{\theta})$ representa el estado del sistema luego de su
interacción con el canal cuántico. Una vez definida la función de costo en la
ecuación~\ref{ec:cost_func}, se procede a ejecutar la tomografía de proceso
con el propósito de reconstruir la matriz de Choi
$\Lambda_{r}$, que será comparada con la matriz de Choi del canal objetivo
$\Lambda_{obj}$ mediante la fidelidad de proceso.
Este procedimiento se repite iterativamente, actualizando
los parámetros $\bm{\theta}$, hasta encontrar el conjunto óptimo:
\begin{equation}
    \label{ec:argmin_cost}
    \theta^* =  \text{arg }\underset{\bm{\theta}}{\text{min}} [ - C(\bm{\theta})].
\end{equation}
%==========================================
\begin{ex}\label{ex:depolarizing}\end{ex}
Como caso de estudio, se considera la implementación de un canal despolarizante (DP) mediante un VQA. En este caso, la matriz de Choi correspondiente al canal objetivo $\Lambda_{obj}$ para un qubit está definida en la ecuación~\ref{ec:choi_depolarizing}. Para aproximar este canal, se construye un ansatz con una sola capa y dos qubits, de la forma (ver figura \ref{fig:ansatz_dp}):
\begin{equation}
    U(\bm{\theta}) = \prod_{j=1}^2 cR_y(\theta_i)\, R_z(\theta_{ij})\, R_x(\theta_{ij2})\, R_z(\theta_{ij3}).
\end{equation}
Los parámetros iniciales $\bm{\theta}_0$ se eligen de manera aleatoria, y el VQA se ejecuta iterativamente hasta alcanzar la minimización de la función de costo definida en la ecuación~\ref{ec:argmin_cost} (véase figura~\ref{fig:esquema_dp}). Cabe resaltar que la matriz de Choi del canal despolarizante depende del parámetro de ruido $p$, por esta razón $\Lambda_r(p)$ debe obtenerse para un valor específico de dicho parámetro.

Iniciamos los parámetros iniciales $(\bm{\theta_0})$ de forma aleatoria y
ejecutamos el VQA hasta alcanzar la minimización de la función de costo
(\ref{ec:argmin_cost})(ver esquema en la figura \ref{fig:esquema_dp}). Notemos
que esta matriz de Choi, se debe especificar para un valor de $p$. En
consecuencia, se obtiene la matriz $\Lambda_r(p)$.
\begin{figure}[h!] 
    \centering 
    \includegraphics[width=0.65\linewidth]{imagenes/ansatz tesis.png}
    \caption{Ansatz perteneciente al ejemplo \ref{ex:depolarizing}, en donde se usa el HEA de la ecuación \ref{ec:ansatz} con restricción de una capa y dos qubits. \textbf{Fuente}: elaboración propia. }
    \label{fig:ansatz_dp}
    \end{figure}
\begin{figure}[h!] 
    \centering 
    \includegraphics[width=0.70\linewidth]{imagenes/esquema_dp_v1.png}
    \caption{Esquema de VQA para la implementación de canales cuánticos de un qubit. \textbf{Fuente}: elaboración propia, basado en esquema general de M. Cerezo y otros \cite{VQA}. }
    \label{fig:esquema_dp}
    \end{figure}

Si ejecutamos este algoritmo en un simulador cuántico para una matriz objetivo del DP con $p=0.25$ tenemos que:
\begin{equation}
    \Lambda_{obj} = \begin{pmatrix}
0.875 & 0 & 0 & 0.75 \\
0 & 0.125 & 0 & 0 \\
0 & 0 & 0.125 & 0 \\
0.75 & 0 & 0 & 0.875
\end{pmatrix},
\end{equation}
mientras que la matriz de Choi optimizada tras utilizar el VQA nos da como
resultado:  
\begin{equation}
  \Lambda_r =  \begin{pmatrix}
(0.918 + 0.000i) & (-0.080 - 0.073i) & (0.092 - 0.098i) & (0.752 + 0.038i) \\
(-0.080 + 0.073i) & (0.082 + 0.000i) & (-0.055 + 0.019i) & (-0.092 + 0.098i) \\
(0.092 + 0.098i) & (-0.055 - 0.019i) & (0.078 + 0.000i) & (0.076 + 0.079i) \\
(0.752 - 0.038i) & (-0.092 - 0.098i) & (0.076 - 0.079i) & (0.922 + 0.000i)
\end{pmatrix},
\end{equation}
que corresponde a una fidelidad de proceso $F_{proc}= 0.9440$. Notemos que el
circuito resultante del ansatz optimizado para este valor de $p$ (ver figura
\ref{fig:ansatz_p025}) no alcanza una fidelidad de proceso igual a uno. Esta diferencia puede atribuirse a dos factores principales. Primero, el optimizador puede converger en un mínimo local, sin alcanzar el valor óptimo global. Segundo, la matriz de Choi $\Lambda_r$ fue obtenida mediante tomografía de proceso, lo que implica realizar estimaciones basadas en un número finito de mediciones, introduciendo así errores de muestreo. Para explicar el segundo punto, calculamos la matriz de Choi $\Lambda_{ar}$ asociada al circuito final optimizado (ver figura \ref{fig:ansatz_p025}) al conjunto de estados vistos en la sección \ref{sec:Tomo_proc} , seguido de la traza parcial sobre los qubits auxiliares, evitando así incertidumbres inherentes a la tomografía. El resultado obtenido es:
\begin{equation}
    \Lambda_{ar} =  \begin{pmatrix}
(0.909 + 0.000i) & (-0.083 - 0.081i) & (0.083 - 0.080i) & (0.748 + 0.038i) \\
(-0.083 + 0.081i) & (0.091 + 0.000i) & (-0.061 + 0.014i) & (-0.083 + 0.080i) \\
(0.083 + 0.080i) & (-0.061 - 0.014i) & (0.087 + 0.000i) & (0.084 + 0.081i) \\
(0.748 - 0.038i) & (-0.083 - 0.080i) & (0.084 - 0.081i) & (0.913 + 0.000i)
\end{pmatrix},
\end{equation}
que tiene una fidelidad de proceso $F_{proc} = 0.9547$. La diferencia evidencia el impacto de los errores de medición y validación estadística en la fidelidad estimada experimentalmente.
\begin{figure}[h!] 
    \centering 
    \includegraphics[width=0.70\linewidth]{imagenes/ansatz_p025_v2.png}
    \caption{Ansatz optimizado para un DP con valor de despolarización $p=0.25$, esto fue optimizado en el simulador \texttt{AerSimulator} de Qiskit, IBM. \textbf{Fuente}: elaboración propia. }
    \label{fig:ansatz_p025}
    \end{figure}

% }}}
% }}}
\chapter{RESULTADOS PARA EL CANAL DESPOLARIZANTE DE UN QUBIT } \label{cap:resultados} % {{{
% Introducción % {{{
Este capítulo presenta los resultados de la implementación del canal despolarizante (DP) de un qubit mediante algoritmos variacionales cuánticos (VQA), como fue planteado en el Capítulo~\ref{cap:algoritmos_variacionales}. En la sección~\ref{sec:algoritmos_vqa}, se describe la programación del VQA en Python utilizando la librería Qiskit, detallando las funciones empleadas para construir el circuito, ejecutar la tomografía de proceso y optimizar la fidelidad del canal respecto a una matriz de Choi objetivo.  En la sección \ref{sec:resultados_dp}, se presentan los resultados obtenidos para distintos valores de la probabilidad de despolarización $p$, utilizando tanto el simulador cuántico \texttt{AerSimulator()} como la computadora cuántica \texttt{ibm\_kyoto}.  \felnote{aquí se mencionan resultados }Se analizaron las fidelidades alcanzadas, verificando que en el simulador estas se mantuvieron consistentemente por encima de 0.900, mientras que en la computadora cuántica se registró una mayor variabilidad, con fidelidades entre 0.5533 y 0.9738 \felnote{Aquí termina la pequeña mención}. Además, se evaluó el cumplimiento de las propiedades fundamentales del canal, tales como la completa positividad (CP) y la preservación de la traza (TP), y se compararon las matrices de Choi reconstruidas con las teóricas.

Por último, en la sección~\ref{sec:discusion_dp}, se discuten las diferencias observadas entre los entornos ideal y real, el impacto del valor de $p$ sobre la fidelidad y los autovalores de las matrices de Choi, así como las limitaciones propias del hardware cuántico. Esta discusión permite valorar la viabilidad y desempeño de los algoritmos variacionales en la implementación de canales cuánticos en plataformas cuánticas actuales, y establecer conclusiones respecto a los objetivos planteados en este proyecto.



\cpnote{Es importante aca mencionar los resultados también. Como un pequeño trailer. } \felnote{Corregido: Lo verás en la nota de correccion arriba }
% }}}
\section{Algoritmos de implementación} % {{{
\label{sec:algoritmos_vqa}
Se han programado las funciones necesarias para implementar un DP mediante VQA
en una computadora cuántica. Estas funciones siguen el algoritmo presentado en
el capítulo anterior, desarrollado en el lenguaje Python con el apoyo esencial
de la librería Qiskit. A continuación, se enumeran las funciones utilizadas: 
\begin{enumerate}
    \item \texttt{Choi\_matrix\_depolarizing(p)}: genera la matriz de Choi que
corresponde al DP con probabilidad de depolarización $p$.

    \item \texttt{Cirq\_ansq(qubits, parameters, layers)}: genera un HEA en un circuito cuántico de Qiskit. Toma como entradas el número de qubits, el listado de ángulos de rotación $\bm{\theta}$ (indicados en \texttt{parameters}) y el número de capas del ansatz (indicado en \texttt{layers}).
    
    \item \texttt{ProcessTomography(circuit, measurement\_indices,
preparation\_indices)}: función de Qiskit que genera los circuitos
correspondientes a la tomografía de proceso para reconstruir la matriz de Choi
en un circuito cuántico. Esta función genera $4^N3^N$ circuitos de medición
acorde a la teoría explicada en el \autoref{cap:fundamentos:teoricos}. Toma como entrada el circuito
cuántico (en  \texttt{circuit})  y el indicador correspondiente al(los)
qubit(s) donde se realizará la tomografía de proceso ( indicado en
\texttt{measurement\_indices} y \texttt{preparation\_indices}) . Tiene el
método: 
    \begin{enumerate}
	\item \texttt{Run(backend)}: método encargado de ejecutar el(los)
circuito(s) cuántico(s) en un servidor de IBM Quantum Experience. El
\texttt{backend} puede ser el simulador de Qiskit  \texttt{AerSimulator()} o
bien, una computadora cuántica en servicio. Invitamos nuevamente al lector a
ver los backends en la documentación de Qiskit \cite{Qiskit_documentation}. 
    \end{enumerate}

    \item \texttt{Process\_fidelity(channel, target)}: función de Qiskit que
mide la fidelidad de proceso entre dos matrices de Choi , (\texttt{channel}
para la matriz de Choi del canal, \texttt{target} para una matriz de Choi
objetivo) \cite{Qiskit_documentation}, acorde a la ecuación
\ref{ec:choi_depolarizing}.
    \item \texttt{Partial\_trace(choi\_matrix,dim)}: calcula la traza parcial
sobre el sistema de una matriz de choi definida en \texttt{choi\_matrix()}.
Este cálculo se realiza dependiendo de la dimensión del sistema cuántico (por
defecto es para dos qubits).
    \item \texttt{Cost\_func(params)}: genera el circuito ansatz usando
\texttt{Cirq\_ansq()}. Posteriormente utiliza \texttt{ProcessTomography()} para
ejecutar la tomografía de proceso sobre el primer qubit del circuito generado.
Finalmente calcula la función de costo usando \texttt{Process\_fidelity()}
entre la matriz de Choi reconstruida del circuito ansatz y una matriz de Choi
objetivo. Esta función usa como entrada global la matriz de Choi objetivo
(\texttt{target} de la función \texttt{Process\_fidelity()}) y como entrada
local la lista de rotaciones $\bm{\theta}$ (definidas en  \texttt{params}).
    \item \texttt{Minimize(fun, x0, method=None, tol)}: función de la librería
\texttt{scipy} encargada de minimización una función escalar \texttt{fun}, de
una o más variables. Esta función requiere un conjunto de parámetros iniciales
de la función \texttt{x0}. Como parte opcional se puede escoger el método de
optimización, invitamos al lector a verlos más a detalle en su respectiva
documentación \cite{scipy}. Finalmente, se puede escoger un valor de tolerancia
(indicado en \texttt{tol})  como criterio de convergencia para el método
utilizado (en \texttt{method}) y que éste se detenga.
\end{enumerate}

Agrupamos estas funciones en una función general encargada de repetir el
proceso de optimización para una lista de valores de $p$. Esta función, llamada
\texttt{optimizar\_depolarizacion(p\_values)} es responsable de generar un
DataFrame de \texttt{pandas} con todos los resultados relevantes de cada
iteración. A continuación la describimos en detalle:

\noindent\rule{\textwidth}{1mm}
\texttt{Optimizar\_depolarizacion(p\_values)}: función para optimizar la
fidelidad del proceso cuántico para una lista de valores de $p$. \newline

\noindent\textbf{Entrada:} lista de valores $p$ para optimizar el ansatz.

\noindent\textbf{Salida:} DataFrame con los valores de $p$, la fidelidad
optimizada, matriz de Choi objetivo, matriz de Choi reconstruida y los
parámetros $\bm{\theta}$ optimizados.

\noindent\textbf{Utiliza:} \texttt{choi\_matrix\_depolarizing},
\texttt{cirq\_ansatz}, \texttt{ProcessTomography}, \texttt{process\_fidelity},
\texttt{cost\_func}, \texttt{minimize}. \newline

Para cada valor de $p$ en \texttt{p\_values}: 
\begin{enumerate}
    \item Generar una matriz de Choi dependiente de $p$ con \texttt{Choi\_matrix\_depolarizing()}.
    \item Iniciar a  \texttt{Cost\_func()} valuado en un conjunto inicial
aleatorio de parámetros $\bm{\theta}$. 
   \item Utilizar \texttt{Minimize()} para iterar recursivamente sobre
\texttt{Cost\_func()}, ajustando los parámetros $\bm{\theta}$ hasta alcanzar
una convergencia definida por \texttt{tol}.
   \item Guardar los parámetros $\{ \theta_i\}$ que minimizan la función de
costo. 
   \item Ejecutar \texttt{ProcessTomography()} con el circuito optimizado 4
veces en el simulador \texttt{AerSimualtor()} y una vez en una computadora
cuántica. 
    \item Almacenar los parámetros optimizados $\{ \theta_i\}$, el circuito
ansatz generado, las matrices de Choi objetvo y reconstruidas en ambos
sistemas, y sus fidelidades de proceso. 
\end{enumerate}
\vspace{-.5cm}
\noindent\rule{\textwidth}{1mm}
% }}}
\section{Resultados} % {{{
\label{sec:resultados_dp}
Para la función general, se fijaron dos hiper parámetros de
\texttt{Cirq\_ansq()}: \texttt{layers} y  qubit. El número de capas se
estableció en 1, ya que no se observó una mejora significativa en los tiempos
de optimización, ni en la minimización de la función de costo al aumentar este
parámetro, esto lo podemos ver en la figura \ref{fig:comparacion_capas}. Por
otro lado, se utilizaron 4 qubits en el ansatz, donde una mitad
funcionó como \textit{ancilla} y la otra para el sistema, siguiendo el diseño
presentado en el ansatz \ref{ec:ansatz}. Esto se decidió porque al
utilizar únicamente dos  qubits no se alcanzó la convergencia en la función de
costo. 

\begin{figure}[h!]  % {{{
    \centering 
    \includegraphics[width=0.70 \linewidth]{imagenes/comparacion_capas.png}
    \caption{Comparación de el proceso de optimización del ansatz utilizado
para el DP a diferentes capas. En azul vemos el resultado para una capa,
amarillo para dos y verde para tres. Estos resultados fueron ejecutados para un
valor de $p=0.125$. \textbf{Fuente}: elaboración propia.}
    \label{fig:comparacion_capas}
\end{figure} % }}}


Para la función \texttt{Minimize}() se fijaron dos hiper parámetros :
\texttt{method} y \texttt{tol}. Se utilizó el método \texttt{COBYLLA}, que
realiza la minimización mediante aproximaciones lineales, mientras que la
tolerancia se ajustó a $1\times 10^{-15}$. Se tomaron estos hiperparámetros
porque con ellos alcanzamos consistentemente la minimización de la función de
costo sin estresar de forma inecesaria el equipo de trabajo. 

Es importante mencionar las limitaciones al usar las computadoras cuánticas de
IBM, donde el tiempo de uso está limitado a 10 minutos mensuales\footnote{Este
es el tiempo de uso disponible en el plan gratuito de IBM.}. Vimos que el
tiempo de ejecución de una tomografía de proceso para un canal de un  qubit
requiere 12 circuitos, que lleva un tiempo de ejecución promedio de $16$s. Por
esta razón decidimos optimizar el ansatz en el simulador cuántico y
posteriormente, ejecutar el circuito optimizado en una computadora cuántica.
Además, el simulador no tiene restricciones de tiempo, por ello ejecutamos el
ansatz optimizado 4 veces para cada valor de $p$ en el simulador de
\texttt{AerSimualtor()}.

La función general se ejecutó para un listado de 38 valores distintos de $p$ en 
\texttt{p\_values}, ajustándose al tiempo mensual disponible en IBM, con un 
margen de error de una tomografía mensual. Cada circuito se ejecutó con 4000 
mediciones tanto en la computadora cuántica como en el simulador.  No incluimos 
todos los resultados detallados en esta sección para evitar sobrecargar la 
discusión\footnote{Se puede acceder al dataframe final, así como al código de 
este proyecto en el github: 
\href{https://github.com/felipechoy1/EPS/tree/main/Código\%20y\%20Resultados}{https://github.com/felipechoy1/EPS/tree/main/Código\%20y\%20Resultados}}.

Los resultados correspondientes a las fidelidades alcanzadas en la computadora
cuántica como en el simulador son presentadas en la figura
\ref{fig:comparacion_fidelidad}. Aquí obtenemos fidelidades en la computadora
cuántica en el rango de $0.553\leq F_{proc} \leq 0.974$. Por otro lado, para el
simulador, el promedio de las fidelidades en las 4 ejecuciones está en el rango
de $0.762\leq F_{proc} \leq 0.993$. Finalmente, al observar la desviación
estándar en los cálculos del simulador, se obtienen valores en el rango de
$0.001\leq \sigma_{F_{proc}} \leq 0.027$. Esta comparación se presenta en la
tabla \ref{tab:comparacion_fidelidades}.



\begin{figure}[h!] 
    \centering 
    \includegraphics[width=0.7\linewidth]{imagenes/comparacion fidelidad.png}
    \caption{Comparación de fidelidades de proceso luego de ejecutar el ansatz
optimizado. En azul se encuentra la fidelidad de la matriz de Choi reconstruida
en el simulador cuántico \texttt{AerSimualtor()}. Por otro lado en azul,
corresponde a la ejecución en la computadora cuántica \texttt{ibm-kyoto}.
\textbf{Fuente}: elaboración propia. }
    \label{fig:comparacion_fidelidad}
    \end{figure}
    

\begin{table}[htbp]
\centering 
\resizebox{\textwidth}{!}{
\begin{tabular}{|l|c|c|c|c|c|c|c|}
\hline
\textbf{Backend} & \textbf{Mediana} & \textbf{Mínimo} & \textbf{Máximo} & \textbf{p(max)} & \textbf{p(min)} & \textbf{Desv. Estándar} \\ \hline
Aer Simulator & 0.9618  & 0.7620  & 0.9925 & 0.975 & 0.725 & 0.0418 \\ \hline
ibm-kyoto     & 0.8916 & 0.5533 & 0.9738 & 0.825 & 0.125 & 0.0899  \\ \hline
\end{tabular}
}
\caption{Comparación de fidelidad de proceso entre las matrices de Choi
reconstruidas del ansatz optimizado. Los resultados de la computadora cuántica
fueron tomados en \texttt{ibm-kyoto}, mientras que en el simulador fueron en
\texttt{AerSimualtor()} de Qiskit. \textbf{Fuente:} elaboración propia.}
\label{tab:comparacion_fidelidades}
\end{table}

Al mismo tiempo, evaluamos la completa positividad (CP) de las matrices de Choi reconstruidas por medio de sus autovalores. Para ello, sabemos que la matriz de Choi del DP esta dado por la ecuación \ref{ec:choi_depolarizing}, por lo que sus autovalores se calculan resolviendo la ecuación característica:
\begin{equation}
\det(\Lambda_\mathcal{E} - \lambda I) = 0,
\end{equation}
donde $\Lambda_\mathcal{E}$ es la matriz de Choi e $I$ es la matriz identidad
de dimensión $4 \times 4$. Para resolver esta ecuación, restamos $\lambda$ de
los elementos diagonales de $\Lambda_\mathcal{E}$:
\begin{equation}
\Lambda_\mathcal{E} - \lambda I = \begin{pmatrix}
1 - \frac{p}{2} - \lambda & 0 & 0 & 1 - p \\
0 & \frac{p}{2} - \lambda & 0 & 0 \\
0 & 0 & \frac{p}{2} - \lambda & 0 \\
1 - p & 0 & 0 & 1 - \frac{p}{2} - \lambda
\end{pmatrix}.
\end{equation}
Al encontrar la determinante de la matriz:
\begin{equation}
\left( \frac{p}{2} - \lambda \right)^2  \left[ \left( 1 - \frac{p}{2} - \lambda \right)^2 - (1 - p)^2 \right] = 0.
\end{equation}
Esto se puede factorizar como:
\begin{equation}
\left( \frac{p}{2} - \lambda \right)^2 \left( \lambda - \frac{p}{2} \right) \left( \lambda - \left( 2 - \frac{3p}{2} \right) \right) = 0.
\end{equation}
Por lo tanto, los autovalores de $\Lambda_{\mathcal{E}}$ son:
\begin{align}
\lambda_1 &=\lambda_2=\lambda_3 = \frac{p}{2} \quad \\
\lambda_4 &= 2 - \frac{3p}{2} .
\end{align}
Comparamos los autovalores de nuestros resultados en la figura
\ref{fig:comparacion_autovalores} para cada valor de $p$. Notamos que todos los
autovalores para todos los valores de $p$ cumplen con ser mayores o iguales a
0. Por lo tanto, los canales reconstruidos cumplen con ser CP.  Por otro
lado, al analizar la condición de preservación de la traza (TP) notamos que
ninguna de las matrices de Choi reconstruidas en ninguno de los sistemas cumple
con preservar la traza. Esto lo verificamos realizando la traza parcial de las matrices de Choi con \texttt{partial\_trace()}, obteniendo resultados que son cercanos a la matriz identidad $I$. Sin embargo, se observan valores no nulos en los elementos fuera de la diagonal, lo que impide que sean exactamente iguales a $I$ (ver figura \ref{fig:ident_comp}).
\begin{figure}[h!] 
    \centering 
    \includegraphics[width=0.90 \linewidth]{imagenes/eigenvalores_comparacion.png}
    \caption{Comparación de autovalores correspondientes a la matriz de Choi reconstruidas. En azul se puede ver el autovalor esperado a lo largo de $p$, en verde vemos el promedio de los valores de las matrices de Choi reconstruidas  en el simulador cuántico \texttt{AerSimualtor()}. Finalmente vemos en rojo los autovalores correspondientes a las matrices de Choi reconstruidas en la computadora cuántica \texttt{ibm-kyoto}. \textbf{Fuente}: elaboración propia. }
    \label{fig:comparacion_autovalores}
\end{figure}


\begin{figure}[h!] % {{{
    \centering
    % Subfigura para p = 0.1
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=0.9\linewidth]{imagenes/ident_comp_0.1.png}
        \caption{Comparación de matrices densidad reducidas para p = 0.1}
        \label{fig:ident_comp_p0.1}
    \end{subfigure}
    \vspace{1em} % Espacio vertical entre subfiguras
    
   
    % Subfigura para p = 0.9
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=0.9\linewidth]{imagenes/ident_comp_0.9.png}
        \caption{Comparación de matrices densidad reducidas para p = 0.9}
        \label{fig:ident_comp_p0.9}
    \end{subfigure}
 \caption{Comparación entre matrices de Choi reducidas objetivo  y  las matrices de Choi reducidas en el simulador cuántico \texttt{AerSimulator()}. Los valores se presentan para disntintas probabilidades de despolarización $p$ del DP. Cada valor representa una componente real de la matriz de Choi reducida. \textbf{Fuente:} elaboración propia.}
    \label{fig:ident_comp}
\end{figure}


% }}}
% }}}
\section{Discusión de Resultados} % {{{
\label{sec:discusion_dp}
En esta sección discutiremos sobre las diferencias encontradas entre las
fidelidades y autovalores calculados en el simulador y la computadora cuántica.
Vemos que estas diferencias se deben en gran parte a que la optimización fue
realizada en el simulador cuántico, el cual esta configurado en un entorno
ideal. 
% Vemos que estas diferencias se deben en gran parte a los errores inherentes al
% hardware cuántico real, como la decoherencia, errores en las compuertas
% cuánticas y limitaciones en la precisión de las mediciones. 


La figura \ref{fig:comparacion_fidelidad} así como la tabla
\ref{tab:comparacion_fidelidades} muestran que el simulador cuántico produce
resultados con fidelidades consistentemente cercanas a 1 a lo largo de todo el
rango de $p$. En contraste, la computadora cuántica presenta una mayor
variabilidad en sus resultados. Para analizar esta diferencia, realizamos una
regresión lineal de la fidelidad en función de $p$ tanto para la computadora
cuántica como para el simulador, como se muestra en la figura
\ref{fig:comparacion_regresiones}.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.95\linewidth]{imagenes/Comparacion_regresiones.png}
    \caption{Comparación de regresiones lineales entre los resultados de la fidelidad de proceso entre la matriz de Choi esperada , la computadora cuántica \texttt{ibm\_kyoto} y el simualdor cuántico \texttt{AerSimualtor()} respectivamente. \textbf{Fuente:} elaboración propia.}
    \label{fig:comparacion_regresiones}
\end{figure}

En el caso de la computadora cuántica, la ecuación de la regresión lineal es:
\begin{equation}
    F_{proc\_qc}(p) = 0.2707 \cdot p + 0.7376,
\end{equation}
con un coeficiente de determinación $R^2 = 0.7055$ y un valor de Chi-cuadrado
de $\chi^2 = 0.1085$.  Esto indica que la fidelidad tiende a aumentar con la
probabilidad de despolarización $p$, pero el ajuste no es perfecto. Los valores
de $R^2$ y $\chi^2$ sugieren que la relación no es estrictamente lineal y que
podría haber otros factores influyendo en los resultados en la computadora
cuántica.

El aumento lineal de la fidelidad puede explicarse porque,
al aumentar $p$ en el DP, los estados se vuelven más
mixtos, reduciendo su sensibilidad a errores específicos del hardware cuántico.
En sistemas como \texttt{ibm\_kyoto}, una alta despolarización reduce la
sensibilidad del estado a errores de compuertas cuánticas y decoherencia, ya
que un estado menos puro tiende a ser menos afectado por estas imperfecciones.

Por otro lado, observamos que el simulador \texttt{AerSimulator()} tiene una
ecuación de la recta:
\begin{equation}
    F_{proc\_sim}(p) = 0.0371 \cdot p + 0.9346,
\end{equation}
con un coeficiente de determinación $R^2 = 0.0612$ y un valor de Chi-cuadrado
de $\chi^2 = 0.0633$. 
Aunque el bajo valor de $R^2$ indica que la relación entre la fidelidad y $p$
en el simulador es débil, sí se observa un aumento lineal sistemático en la
fidelidad con respecto a $p$. La pequeña pendiente de la recta sugiere que el
cambio en la fidelidad es leve y se mantiene prácticamente constante a lo largo
del rango de $p$, aunque no completamente insensible al aumento de $p$.

Analizamos la variabilidad de fidelidad en ambos casos, como se muestra en la
figura \ref{fig:comparacion_desviaciones}. En el simulador cuántico, no se
observa una tendencia clara en la desviación estándar de la fidelidad a lo
largo de $p$, excepto en el intervalo $0.6 \le p \leq 0.75$, que parece ser una
anomalía en los datos. Por otro lado, la computadora cuántica muestra una
reducción en la desviación estándar de la fidelidad a medida que aumenta $p$,
lo que confirma nuestra suposición basada en la regresión lineal. Finalmente,
en ambos casos, observamos que para valores de $p>0.75$, la desviación estándar
disminuye significativamente.


\begin{figure}[h!] % {{{
    \centering
    \includegraphics[width=0.95\linewidth]{imagenes/Comparacion_desviaciones.png}
    \caption{Comparación de desviación estándar entre los resultados de la fidelidad de proceso entre la matriz de Choi esperada , la computadora cuántica \texttt{ibm\_kyoto} (color naranja) y el simualdor cuántico (color azul) \texttt{AerSimualtor()}. La desviación estándar se calcula sobre los valores de fidelidad en el intervalo de $p$. \textbf{Fuente:} elaboración propia.}
    \label{fig:comparacion_desviaciones}
\end{figure} % }}}


Al analizar los cuatro autovalores presentados en la figura
\ref{fig:comparacion_autovalores}, notamos que tanto en el simulador como en la
computadora cuántica, los autovalores $\lambda_1,\lambda_2,\lambda_3$ no son
iguales entre sí. Además, en todos los casos, la computadora cuántica se desvía
más de los resultados esperados en comparación con el simulador.
Específicamente, observamos que la computadora cuántica comienza con valores
más altos para $\lambda_1,\lambda_2,\lambda_3$, y también con valores más bajos
para $\lambda_4$ en comparación con el simulador.  Estos primeros tres
autovalores están relacionados con la probabilidad de que el canal mantenga el
estado cuántico original, mientras que el cuarto autovalor corresponde a la
probabilidad de que el estado cuántico se vuelva completamente mixto. Por lo
tanto, estas observaciones sugieren que la computadora cuántica introduce más
ruido desde etapas tempranas, que se refleja en una tendencia menos pronunciada
en comparación con el simulador. Esta interpretación es coherente con los
resultados obtenidos en la regresión lineal, donde el intercepto de la
fidelidad en la computadora cuántica ($0.7376$) es menor que en el simulador,
que muestra fidelidades iniciales más altas y con menor variabilidad
($0.9346$).

En la figura \ref{fig:comparacion_choi}, observamos que las
matrices de Choi generadas por la computadora cuántica presentan mayor
coherencia en las entradas no diagonales. Esto también nos muestra que la
computadora cuántica introduce ruido desde un inicio del proceso de
despolarización debido a las imperfecciones inherentes al hardware y las
compuertas cuánticas. Notemos que al incrementar $p$, aumentamos la probabilidad de
despolarización, lo cual introduce más ruido a la interacción del sistema con
el estado máximamente mixto (ver ecuación
\ref{ec:superop_depolarizing}). Este proceso provoca una mejora en la
fidelidad porque, al hacer que los estados sean menos puros, se vuelven menos
sensibles a errores específicos del hardware cuántico. 

Por otro lado, las matrices obtenidas del simulador son
más consistentes con los valores teóricos, con valores casi nulos en las
posiciones no diagonales, reflejando mayor fidelidad en la simulación del canal
a lo largo de $p$.

\begin{figure}[h!] % {{{
    \centering
    % Subfigura para p = 0.1
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=1\linewidth]{imagenes/comp_choi_p0.1.png}
        \caption{Comparación de matrices de Choi para p = 0.1}
        \label{fig:choi_p0.1}
    \end{subfigure}
    \vspace{1em} % Espacio vertical entre subfiguras
    
    % Subfigura para p = 0.9
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=1\linewidth]{imagenes/comp_choi_p0.9.png}
        \caption{Comparación de matrices de Choi para p = 0.9}
        \label{fig:choi_p0.9}
    \end{subfigure}
    
    \caption[Comparación de matrices de Choi objetivo y
reconstruidas]{
    Comparación de matrices de Choi objetivo y matrices de Choi reconstruidas en el simulador cuántico \texttt{AerSimulator()}, como en la computadora cuántica \texttt{ibm\_kyoto}. Los valores se presentan para disntintas probabilidades de despolarización $p$ del DP. Cada valor representa una componente real de la matriz de Choi. \textbf{Fuente:} elaboración propia.}
    \label{fig:comparacion_choi}
\end{figure} % }}

% }}}
% }}}
% }}}
\backmatter
\chapter{CONCLUSIONES} % {{{
En este trabajo abordamos la implementación de canales cuánticos de un qubit
utilizando algoritmos variacionales cuánticos (VQA). Diseñamos e implementamos
un canal despolarizante (DP) mediante un \textit{hardware-efficient} ansatz, el
cual fue optimizado en un simulador cuántico y validado en un dispositivo
cuántico real a través de la plataforma IBM Quantum Experience
\cite{VQA,ibm_quantum_resources}. A partir de este enfoque, se empleó una
función de costo basada en la fidelidad de proceso, que comparó el canal
implementado con el canal objetivo. La evaluación se realizó tanto en un
simulador (\texttt{AerSimulator}) como en una computadora cuántica
(\texttt{ibm\_kyoto}) para distintos valores del parámetro de despolarización
$p$. Se observó que, en el caso del simulador cuántico, la fidelidad de proceso
mantuvo sus valores con baja variación, además de tener valores de fidelidad
superiores a 0.900 en la mayoría de casos. 

Por otro lado, los resultados obtenidos en la computadora cuántica mostraron un
comportamiento distinto. La fidelidad de proceso tendió a aumentar conforme
crecía la probabilidad de despolarización $p$ (ver figura
\ref{fig:comparacion_fidelidad}). Para analizar esta tendencia, se aplicó una
regresión lineal con pendiente $m = 0.2707$, que indica un crecimiento moderado
de la fidelidad con respecto a $p$. También observamos una disminución en la
variabilidad de la fidelidad al aumentar $p$, lo cual podría atribuirse a que,
al incrementar la despolarización, los estados cuánticos se vuelven más mixtos
y, por ende, más tolerantes a los errores introducidos por el hardware. Sin
embargo, el coeficiente de determinación $R^2 = 0.7055$ sugiere que existen
otros factores, además de $p$, que influyen en el comportamiento observado.
Esta influencia adicional se evidenció al inspeccionar las matrices de Choi
reconstruidas (ver figura~\ref{fig:comparacion_choi}), donde notamos que, en
las primeras etapas del proceso, el dispositivo cuántico conservaba coherencias
mayores en las entradas no diagonales. En conjunto, estos resultados indican
que, en entornos ideales, los VQA pueden ser efectivos para la implementación
de canales cuánticos. No obstante, en dispositivos cuánticos reales, la
fidelidad y estabilidad del canal implementado se ven afectadas por el ruido
propio del hardware, el cual debe ser considerado cuidadosamente durante el
diseño y la ejecución del algoritmo.







% Por otro lado, los resultados obtenidos en la computadora cuántica presentaron un comportamiento distinto. La fidelidad tendió a aumentar conforme crecía la interacción con el ruido del dispositivo (ver figura  \ref{fig:comparacion_fidelidad}). Analizamos esta tendencia con una regresión lineal , cuya pendiente fue $m = 0.2707$, que indica un crecimiento moderado de la fidelidad con $p$. También observamos una disminución en la variabilidad de la fidelidad al aumentar $p$. Este fenómeno puede atribuirse a que, al aumentar la probabilidad de despolarización, los estados cuánticos se vuelven más mixtos y, por lo tanto, más susceptibles a errores introducidos por el hardware. Sin embargo, el coeficiente de determinación $R^2=0.7055$  sugiere que existen otros factores, además de $p$, que influyen en el comportamiento de la fidelidad en el dispositivo cuántico. Estos factores se evidenciaron al inspeccionar las matrices de Choi (ver figura \ref{fig:comparacion_choi}), donde la computadora cuántica presentaba una mayor coherencia en las entradas no diagonales en las primeras etapas del proceso. Finalmente, los resultados obtenidos muestran que en entornos ideales, los VQA pueden ser efectivos para implementar canales cuánticos. No obstante, en computadoras cuánticas reales,
% la precisión se ve afectada por la naturaleza del hardware, ya que este introduce una fuente adicional de ruido que debe ser considerado al momento de la implementación. 
% }}}
\chapter{TRABAJO FUTURO} % {{{
Los resultados obtenidos en la computadora cuántica abren diversas líneas de
investigación para trabajos futuros. A continuación, se proponen algunas de
ellas: 
\begin{itemize}
    \item Explorar diferentes tipos de \textit{ansatz} para el entrenamiento y la optimización de la fidelidad de proceso, como se describió en la sección \ref{sec:desc_vqa}. En este trabajo se enfocó el estudio en \textit{hardware-efficient ansatz} (HEA) debido a su amplio uso actual. Sin embargo, la evaluación de otros tipos de \textit{ansatz} podría conducir a un mejor desempeño en computadoras cuánticas reales.
    
    \item Implementar los VQA para canales cuánticos de dos o más qubits. Dado que el \textit{ansatz} presentado en la ecuación \ref{ec:ansatz} es generalizable para $n$ qubits, es posible extender este esquema a la implementación de canales cuánticos de mayor dimensión. El principal desafío en este caso radica en las limitaciones del hardware cuántico actual, así como en el aumento de los recursos necesarios para la optimización en simuladores cuánticos.
    
    \item Realizar la optimización directamente sobre hardware cuántico. En este trabajo se utilizó exclusivamente la plataforma IBM Quantum Experience, la cual presenta ciertas restricciones en el tiempo de ejecución. Sin embargo, explorar otras plataformas podría permitir realizar optimizaciones directamente en el dispositivo, lo que abriría la posibilidad de obtener mejores resultados y de realizar un análisis más detallado del desempeño del hardware.
\end{itemize}
% }}}
\bibliographystyle{abbrv}
\bibliography{references} % Bibliografía


% \appendix
% \chapter*{A.1}

% \addcontentsline{toc}{chapter}{A.1}
\end{document}